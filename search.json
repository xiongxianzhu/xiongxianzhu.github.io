[{"title":"如何使用claude code","url":"/2025/11/10/how-to-use-claude-code/","content":"Claude Code是Anthropic推出的AI编程助手，它可以直接在终端中工作，帮助开发者编写、审查和修改代码。本文将详细介绍如何搭建Claude Code环境以及基本使用方法。\n\n## 1. 环境搭建\n\n### 1.1 前提条件\n\n- Node.js 18+\n\n### 1.2 安装方法\n\nClaude Code提供多种安装方式，您可以根据自己的系统选择最适合的方法：\n\nNPM安装(官方推荐)\n\n```bash\nnpm install -g @anthropic-ai/claude-code\n```\n\n### 1.3 验证安装\n\n安装完成后，您可以通过以下命令验证是否安装成功：\n\n```bash\nclaude --version\n```\n\n如果成功安装，系统将显示Claude Code的版本信息。\n\n### 1.4 配置认证\n\n```bash\nclaude\n```\n\n然后输入 /login 并用你的 Claude.ai 账号（或 Anthropic 控制台）授权\n\n#### 1.4.1 自定义API端点配置\n\n在某些情况下，您可能需要配置自定义API端点或使用特定的认证令牌。Claude Code支持通过以下环境变量进行自定义配置：\n\n**ANTHROPIC_BASE_URL**：用于指定自定义的API基础URL\n\n```bash\n# 设置自定义API端点\nexport ANTHROPIC_BASE_URL=\"https://your-custom-api-endpoint.com/v1\"\n\n# 在Windows PowerShell中\n$env:ANTHROPIC_BASE_URL=\"https://your-custom-api-endpoint.com/v1\"\n```\n\n**ANTHROPIC_API_KEY**：用于指定Claude API密钥\n\n```bash\n# 设置Claude API密钥\nexport ANTHROPIC_API_KEY=\"your-anthropic-api-key\"\n\n# 在Windows PowerShell中\n$env:ANTHROPIC_API_KEY=\"your-anthropic-api-key\"\n```\n\n或，**ANTHROPIC_AUTH_TOKEN**：用于指定自定义的认证令牌\n\n```bash\n# 设置自定义认证令牌\nexport ANTHROPIC_AUTH_TOKEN=\"your-custom-auth-token\"\n\n# 在Windows PowerShell中\n$env:ANTHROPIC_AUTH_TOKEN=\"your-custom-auth-token\"\n```\n\n#### 1.4.2 持久化配置\n\n如果您希望永久保存这些配置，可以将它们添加到系统的环境变量中：\n\n**Linux/macOS**：将以下内容添加到`~/.bashrc`、`~/.zshrc`或`~/.profile`\n\n```bash\nexport ANTHROPIC_BASE_URL=\"https://your-custom-api-endpoint.com/v1\"\nexport ANTHROPIC_AUTH_TOKEN=\"your-custom-auth-token\"\n```\n\n**Windows**：通过\"系统属性\" > \"高级\" > \"环境变量\"界面添加\n\n或者，您可以创建Claude Code的配置文件：\n\n```bash\n# 创建配置目录\nmkdir -p ~/.claude\n\n# 创建配置文件\ncat > ~/.claude/settings.json << EOF\n{\n    \"env\": {\n        \"ANTHROPIC_BASE_URL\": \"https://your-custom-api-endpoint.com/v1\",\n        \"ANTHROPIC_AUTH_TOKEN\": \"your-custom-auth-token\",\n        \"ANTHROPIC_MODEL\": \"claude-3-5-sonnet-20240620\"\n    }\n}\nEOF\n```\n\n## 2. 基本用法\n\n### 2.1 启动Claude Code\n\n在您的项目目录中，运行以下命令启动Claude Code：\n\n```bash\nclaude\n```\n\n这将启动交互式REPL环境，您可以开始与Claude对话。\n\n### 2.2 基本命令\n\n#### 查看帮助\n\n```bash\nclaude --help\n```\n\n#### 直接执行任务\n\n您可以直接通过命令行执行任务，而无需进入交互模式：\n\n```bash\nclaude -p \"请解释这个函数的功能\"\n```\n\n#### 查看配置\n\n```bash\n/config\n```\n\n此命令将打开一个选项卡式设置界面，您可以在其中查看状态信息并修改配置选项。\n\n### 2.3 常见工作流程\n\n#### 代码审查\n\n让Claude审查您的代码：\n\n```bash\nclaude -p \"请审查当前目录中的所有Python文件，检查潜在的性能问题和代码风格\"\n```\n\n#### 错误修复\n\n当遇到错误时，可以让Claude帮助修复：\n\n```bash\nclaude -p \"我遇到了这个错误：[错误信息]，请帮我找出问题所在并提供修复方案\"\n```\n\n#### 功能实现\n\n请求Claude实现特定功能：\n\n```bash\nclaude -p \"请创建一个函数，用于从API获取数据并处理错误\"\n```\n\n### 2.4 高级用法\n\n#### 作为Unix工具使用\n\nClaude Code可以与其他命令行工具组合使用：\n\n```bash\ntail -f app.log | claude -p \"如果日志中出现异常，请通知我\"\n```\n\n#### 集成到CI/CD\n\n将Claude Code集成到您的构建脚本中：\n\n```json\n// package.json\n{\n    ...\n    \"scripts\": {\n        ...\n        \"lint:claude\": \"claude -p '你是一个代码检查工具，请检查与main分支相比的更改，报告与拼写错误相关的问题。在一行中返回文件名和行号，在第二行返回问题描述，不要返回任何其他文本。'\"\n    }\n}\n```\n\n## 3. 最佳实践\n\n### 3.1 项目配置\n\n在项目根目录创建`CLAUDE.md`文件，定义编码标准、审查标准和项目特定规则。Claude在运行期间会读取此文件并遵循您的约定。\n\n示例`CLAUDE.md`内容：\n\n```markdown\n## 技术栈\n\n技术栈：Python 3.13 + Flask 3 + SQLAlchemy + Gunicorn + PostgreSQL + Redis\n\n## 代码规范\n\n### 基础规范\n\n- 遵循 **PEP 8** 规范  \n- 缩进：4 个空格  \n- 文件编码：UTF-8  \n- 使用 **类型注解（type hints）**  \n- 文件名：`snake_case` 风格，例如 `user_service.py`  \n- 函数名：`snake_case`  \n- 类名：`PascalCase`  \n- 常量名：全大写（如 `MAX_RETRY_COUNT`）  \n- 注释：简洁明了，代码逻辑可用英文；业务逻辑需中文说明\n- 所有日期时间字段统一使用 **东八区时间**\n\n### 数据库与 ORM 约定\n\n- 使用 SQLAlchemy ORM  \n- 主键字段名统一为：`id`  \n- 时间字段命名规范：\n  - 创建时间：`created_at`\n  - 更新时间：`updated_at`\n  - 预约时间：`appt_at`  \n- 枚举字段命名采用全大写英文值\n\n### API 开发规范\n\n- 所有API路由均以`/api`开头\n- 使用JSON格式进行数据交换\n- 所有API响应均包含状态码和消息体\n- 状态码：200表示成功，400表示客户端错误，500表示服务器错误\n- 消息体：包含必要的信息，如错误消息、数据等，响应结构示例：\n\n    ```json\n    {\n        \"code\": 0,\n        \"message\": \"success\",\n        \"data\": {}\n    }\n    ```\n\n```\n\n### 3.2 提示技巧\n\n1. **明确具体**：提供清晰、具体的指令\n2. **提供上下文**：包含足够的背景信息\n3. **分步请求**：将复杂任务分解为多个步骤\n4. **迭代改进**：根据结果逐步完善请求\n\n### 3.3 成本优化\n\n1. **使用提示模板**：为常见任务创建提示模板\n2. **保持CLAUDE.md简洁**：专注于最重要的规则\n3. **配置适当超时**：为您的工作流设置合理的超时时间\n\n## 4. 故障排除\n\n### 4.1 常见问题\n\n#### 安装问题\n\n如果在Linux上遇到权限问题，请查阅[故障排除指南](https://code.claude.com/docs/zh-CN/troubleshooting#linux-permission-issues)。\n\n#### 认证问题\n\n如果遇到认证问题，请确保：\n\n- API密钥有效且未过期\n- 网络连接正常\n- 防火墙未阻止Claude Code的连接\n\n#### 自定义API端点问题\n\n当使用ANTHROPIC_BASE_URL和ANTHROPIC_AUTH_TOKEN时，可能遇到以下问题：\n\n1. **连接超时**：\n   - 检查ANTHROPIC_BASE_URL是否正确且可访问\n   - 验证网络连接是否稳定\n   - 确认端点是否需要特定的TLS/SSL配置\n\n2. **认证失败**：\n   - 验证ANTHROPIC_AUTH_TOKEN是否有效\n   - 检查令牌格式是否正确（是否包含必要的前缀）\n   - 确认令牌是否有足够的权限访问请求的资源\n\n3. **配置冲突**：\n   - 检查是否存在多个配置源冲突\n   - 验证环境变量优先级是否按预期工作\n   - 确认配置文件格式是否正确\n\n4. **调试技巧**：\n\n```bash\n# 使用详细模式查看请求详情\nclaude -v -p \"测试请求\"\n\n# 检查当前配置\nclaude config show\n\n# 测试API连接\ncurl -H \"Authorization: Bearer $ANTHROPIC_AUTH_TOKEN\" \\\n     -H \"Content-Type: application/json\" \\\n     -d '{\"model\": \"claude-3-sonnet-20240229\", \"max_tokens\": 10, \"messages\": [{\"role\": \"user\", \"content\": \"Hi\"}]}' \\\n     \"$ANTHROPIC_BASE_URL/messages\"\n```\n\n### 4.2 获取帮助\n\n如果遇到问题，可以通过以下方式获取帮助：\n\n- 查看官方文档：[Claude Code文档](https://code.claude.com/docs/zh-CN)\n- 提交问题：[GitHub Issues](https://github.com/anthropics/claude-code/issues)\n- 社区支持：[Claude社区论坛](https://community.anthropic.com)\n\n## 附录\n\n[七牛云-Anthropic API 兼容和Claude Code 配置](https://developer.qiniu.com/aitokenapi/13085/claude-code-configuration-instructions)\n[官方Claude Code 环境变量配置](https://code.claude.com/docs/zh-CN/settings#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F)\n[智谱AI-Claude Code配置](https://docs.bigmodel.cn/cn/coding-plan/tool/claude)\n[Claude Docs](https://docs.claude.com/zh-CN/home)\n","tags":["ai","claude code"],"categories":["ai"]},{"title":"win11安装nodejs","url":"/2024/07/21/win11-install-nodejs/","content":"\n`win + x + a`打开PowerShell，输入以下命令安装nodej：\n\n```sh\nwinget install Schniz.fnm\n\n# 重启powershell后fnm生效\nfnm install 22\n\nfnm use --install-if-missing 22\n\nnode -v\n\nnpm -v\n```\n\n查看nodejs安装路径：\n\n```sh\nfnm install 22\n# Installing Node v22.5.1 (x64)\n# warning: Version already installed at \"C:\\\\Users\\\\xx\\\\AppData\\\\Roaming\\\\fnm\\\\node-versions\\\\v22.5.1\"\n```\n\nnodejs安装目录`C:\\Users\\xx\\AppData\\Roaming\\fnm\\node-versions\\v22.5.1\\installation`添加到环境变量中，即可全局使用nodejs。\n","tags":["nodejs","npm"],"categories":["前端"]},{"title":"pyenv的用法","url":"/2024/03/22/pyenv-usage/","content":"\n## 1. 显示可安装的python版本\n\n```bash\npyenv install --list\n```\n\n## 2. 安装某个python版本\n\n```bash\npyenv install 3.12.1\n```\n\n## 3. 显示本地已安装的Python版本\n\n```bash\npyenv versions\n```\n\n## 4. 切换python版本\n\n```bash\npyenv global 3.12.1\n```\n\n## 5. 显示Python执行文件路径\n\n```bash\npyenv which python3.12\n```\n","tags":["python","pyenv"],"categories":["python"]},{"title":"快速上手vue","url":"/2023/05/09/how-to-learn-vue/","content":"\n## 1. 官网\n\nvue官网：<https://cn.vuejs.org>\nnodejs官网： <https://nodejs.org/en>\n\n最快最有效的入手方法就是先从官网入手。\n\n## 2. 环境准备及常用命令\n\n- 安装最新版本的nodejs，直接到官网下载安装包安装即可\n- 安装cnpm，使用cnpm管理v依赖可以走国内源，加速依赖的安装\n- 安装yarn，使用yarn管理vue项目的依赖\n- 安装n模块，用n模块管理nodejs版本\n\n安装cnpm：\n\n```bash\nsudo npm install -g cnpm --registry=https://registry.npmmirror.com/\n```\n\n安装n模块：\n\n```bash\n# 安装\nsudo npm install -g n\n# 查看帮助\nn -h\n```\n\n安装yarn：\n\n```bash\n# 安装\nsudo npm install -g yarn\n# 查看帮助\nyarn -h\n\n# 查看yarn当前源\nyarn config get registry\n# 查看npm当前源\nnpm config get registry\n# 查看cnpm当前源\nncpm config get registry\nor\nnpm get registry\n```\n\n默认源：\n\n```plain\n# yarn默认源\nhttps://registry.yarnpkg.com\n# npm默认源\nhttps://registry.npmjs.org/\n```\n\nyarn设置国内源：\n\n```bash\nyarn config set registry https://registry.npmmirror.com/ --global\nyarn config set disturl https://npmmirror.com/dist --global\n```\n\nnpm设置国内源：\n\n```bash\nnpm config set registry https://registry.npmmirror.com/ --global\n```\n\ncnpm设置国内源：\n\n```bash\ncnpm config set registry https://registry.npmmirror.com/ --global\n```\n\nn常用命令：\n\n```bash\n# 切换nodejs版本，可以查看所有已安装的node版本，可以根据上下和回车选择要使用的版本\nn\n# 升级node.js到最新稳定版\nsudo n stable\n# 升级node.js到最新版\nsudo n latest\n# n后面也可以跟随版本号,升级到任意版本\nsudo n v20.1.0 or sudo n 20.1.0\n# 切换使用版本\nsudo n 20.1.0\n# 删除制定版本\nsudo n rm 20.1.0\n# 查看帮助\nn -h\n```\n\n查看版本常用命令：\n\n```bash\n# 查看ndoejs版本\nnode -v\n# 查看npm版本\nnpm -v\n# 查看cnpm版本\ncnpm -v\n# 查看n版本\nn -V\n```\n\n## 3. 创建应用、安装依赖、运行项目\n\n```bash\nnpm init vue@latest\n\ncd <your-project-name>\nnpm install\nnpm run dev\n\nor\n\nyarn install\nyarn run dev\n```\n\n至此，完成了新手的vue项目创建、安装依赖、运行项目。\n","tags":["nodejs","npm","vue","yarn"],"categories":["vue"]},{"title":"linux基本信息及监控指标获取","url":"/2021/03/27/linux-info-stats/","content":"\n#### 1. 系统信息\n\n内核版本：\n\n```bash\ncat /proc/version\n\nuname -a\n\nuname -r\n```\n\nlinux系统版本：\n\n```bash\nuname -a\n\ncat /etc/redhat-release\n\ncat /etc/issue\n\nlsb_release -a\n```\n\n#### 2. cpu\n\ncpu详细信息：\n\n```bash\ncat /proc/cpuinfo\n```\n\ncpu个数：\n\n```bash\ncat /proc/cpuinfo| grep \"physical id\"| sort| uniq| wc -l\n```\n\n逻辑cpu`processor`个数：\n\n```bash\ncat /proc/cpuinfo |grep \"processor\"|wc -l\n\ncat /proc/cpuinfo |grep \"processor\"\n```\n\n#### 3. 内存\n\n```bash\ncat /proc/meminfo\n\ntop\n\nfree\n\nfree -m\n\nfree -g\n```\n\n#### 4. 磁盘\n\n磁盘使用情况统计：\n\n```bash\ndf -lh\n```\n\n文件或目录的磁盘占用统计：\n\n```bash\ndu -sh 文件/目录\n\ndu -sh *\n\ndu -sh .\n```\n","tags":["linux","cpu","内存","系统版本","磁盘"],"categories":["linux"]},{"title":"mac下安装go开发环境","url":"/2021/03/18/install-go-on-mac/","content":"\n#### 1. 下载go安装包\n\n官网下载go安装包： <https://golang.google.cn/dl/>\n\n下载go二进制包`go1.20.3.darwin-amd64.tar.gz`或`go1.20.3.darwin-arm64.tar.gz`\n\n注意：选择amd64还是arm64取决于你电脑CPU的架构是x86_64还是arm架构，x86用amd64的包，arm则用arm64的包。mac的CPU目前主要有2种，分别Intel和M系列如m1, m2。CPU为Intel的则为x86_64架构，CPU为m1,m2,...则为arm架构。\n\n```bash\nwget -c https://golang.google.cn/dl/go1.20.3.darwin-amd64.tar.gz\n\nor\n\nwget -c https://golang.google.cn/dl/go1.20.3.darwin-arm64.tar.gz\n```\n\n#### 2. 安装go\n\n安装目录： `/usr/local/go`\n\n```bash\nsudo tar -xzvf go1.20.3.darwin-amd64.tar.gz -C /usr/local\n\nor\n\nsudo tar -xzvf go1.20.3.darwin-arm64.tar.gz -C /usr/local\n\ncd /usr/local/go\n```\n\n查看go的安装目录:\n\n```\ncd /usr/local/go\nls\n```\n\n#### 3. 配置环境变量\n\n编辑`~/.bash_profile`文件：\n\n```\nvim ~/.bash_profile\n```\n\n追加以下内容：\n\n```\nexport GOROOT=/usr/local/go\nexport PATH=$PATH:$GOROOT/bin\nexport GOPATH=$HOME/go\n```\n\n注意， `GOPATH`配置为你的工作区目录\n\n编辑`~/.zshrc`文件：\n\n```\nvim ~/.zshrc\n```\n\n追加以下内容：\n\n```\nsource ~/.bash_profile\n```\n\n使终端对以上配置的环境变量生效：\n\n```\nsource ~/.zshrc\n```\n\n#### 4. 检测go开发环境是否安装成功\n\n```\n$ go env\n\n省略...\n\nGOPATH=\"/Users/xx/go\"\nGOROOT=\"/usr/local/go\"\n\n省略...\n```\n\n其中，\n\n- GOPATH： go工作区， 即编写代码存放的目录\n- GOROOT： go的安装目录\n\n查看版本：\n\n```bash\n$ go version\ngo version go1.20.3 darwin/amd64\n\nor\n\n$ go version\ngo version go1.20.3 darwin/arm64\n```\n\n在`GOPATH`工作区目录下， 一般有3个目录， 分别是\n\n- bin: 存储可执行bin文件\n- pkg: 编译完成的文件\n- src: 源代码文件\n\n`$GOPATH/pkg`目录在执行`go get -u 库名`会自动创建， `src`目录不存在则需要手动创建， 示例如下：\n\n```bash\nmkdir -p $GOPATH/src\nmkdir -p $GOPATH/bin\n```\n\n在`$GOPATH/src`目录下， 创建新项目进行开发\n\n#### 5. 设置go国内模块代理\n\n参考： https://goproxy.cn/\n\n编辑`~/.bash_profile`:\n\n```bash\nvim ~/.bash_profile\n```\n\n追加以下内容：\n\n```bash\nexport GO111MODULE=on\nexport GOPROXY=https://goproxy.cn\n```\n\n使以上配置的环境变量生效：\n\n```bash\nsource ~/.zshrc\n```\n\n至此， go开发环境安装成功。\n\n#### 6. 创建go的hello项目\n\n创建go的hello项目：\n\n```bash\n$ cd $GOPATH/src\n$ mkdir hello\n$ cd hello\n$ go mod init zhuxiongxian.com/hello\ngo: creating new go.mod: module zhuxiongxian.com/hello\ngo: to add module requirements and sums:\n    go mod tidy\n$ go mod tidy\n```\n\n其中，\n\n- `go mod tidy`: 增加缺少的module， 删除无用的module\n- go get/go run/go build会自动下载依赖\n\n创建hello.go文件:\n\n```bash\nvim hello.go\n```\n\nhello.go文件内容如下：\n\n```go\npackage main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"Hello, World!\")\n}\n\n```\n\n运行go的hello项目：\n\n```bash\n$ cd cd $GOPATH/src/hello\n$ go run .\nHello, World!\n```\n\n#### 7. 安装gin框架\n\n```bash\ngo get -u github.com/gin-gonic/gin\n```\n\n在代码中导包：\n\n```go\nimport \"github.com/gin-gonic/gin\"\n```\n\n#### 8. 创建gin的demo项目\n\n```bash\ncd $GOPATH/src\nmkdir gin-demo\ncd gin-demo\nvim example.go\n```\n\nexample.go文件内容：\n\n```go\npackage main\n\nimport \"github.com/gin-gonic/gin\"\n\nfunc main() {\n    r := gin.Default()\n    r.GET(\"/ping\", func(c *gin.Context) {\n        c.JSON(200, gin.H{\n            \"message\": \"pong\",\n        })\n    })\n    // r.Run() // listen and serve on 0.0.0.0:8080 (for windows \"localhost:8080\")\n    r.Run(\":10240\")\n}\n```\n\n```bash\ngo mod init zhuxiongxian.com/gin-demo\ngo mod tidy\ngo run example.go\n或\ngo run .\n```\n\n访问： http://0.0.0.0:10240/ping\n\n```bash\n{\n    \"message\": \"pong\"\n}\n```\n\n#### 9. 常用命令\n\n```bash\n// 查看go当前版本\ngo version\n// 查看当前go的环境变量\ngo env\n// 列出当前全部安装的依赖库\ngo list\n// 编辑并运行go程序\ngo run\n// 自动更新依赖库\ngo get -u\n// 增加缺少的module， 删除无用的module\ngo mod tidy\n```\n","tags":["mac","go"],"categories":["go"]},{"title":"使用vscode作为开发利器","url":"/2021/03/17/using-vscode/","content":"\n#### 1. 下载并安装vscode\n\n#### 2. 配置主题\n\n#### 3. 安装插件\n\n#### 4. 设置终端调起命令\n\n\n","tags":["mac","vscode","开发工具"],"categories":["开发工具"]},{"title":"配置docker国内镜像源加速获取docker镜像","url":"/2021/03/10/docker-registry-mirrors-config/","content":"\n#### 1. docker国内镜像源\n\nDocker 官方中国区\n\n```\nhttps://registry.docker-cn.com\n```\n\n网易\n\n```\nhttp://hub-mirror.c.163.com\n```\n\n中国科技大学\n\n```\nhttps://docker.mirrors.ustc.edu.cn\n```\n\n阿里云\n\n```\nhttps://<阿里云给你分配的随机码>.mirror.aliyuncs.com\n```\n\n七牛云\n\n```\nhttps://reg-mirror.qiniu.com\n```\n\n#### 2. 配置docker镜像源为阿里源\n\n配置镜像源为国内源可以提升获取Docker官方镜像的速度。\n\n获取阿里云的docker源：\n\n登录你的阿里云控制台--容器镜像服务--镜像中心--镜像加速器\n\n获取加速器地址：\n\n```\nhttps://<阿里云给你分配的随机码>.mirror.aliyuncs.com\n```\n\n```\nmkdir -p /etc/docker/\nvim /etc/docker/daemon.json\n```\n\ndaemon.json文件内容：\n\n```\n{\n    \"registry-mirrors\": [\n        \"https://<阿里云给你分配的随机码>.mirror.aliyuncs.com\"\n    ]\n}\n```\n\n或\n\n```\nsudo mkdir -p /etc/docker\nsudo tee /etc/docker/daemon.json <<-'EOF'\n{\n  \"registry-mirrors\": [\"https://<阿里云给你分配的随机码>.mirror.aliyuncs.com\"]\n}\nEOF\n```\n\n#### 3. 重启docker服务生效\n\n重启docker服务使配置生效：\n\n```\nsystemctl daemon-reload\nsystemctl restart docker\n```\n\n#### 4. 检测\n\n```\ndocker info\n```\n\n查看`Registry Mirrors`是否配置成功。\n","tags":["docker"],"categories":["docker"]},{"title":"使用gitlab-ce搭建git服务","url":"/2021/03/10/using-gitlab-ce-to-build-git-service/","content":"\n使用docker安装gitlab\n\nhttps://docs.gitlab.com/omnibus/docker/\n\nhttps://docs.gitlab.com/omnibus/docker/#install-gitlab-using-docker-compose\n\nhttps://docs.docker.com/engine/install/centos/\n\nGitlab-ce与Gitlab-ee的区别在于：\n\n- gitlab-ce: 社区版\n- gitlab-ee: 企业收费版\n\n#### 1. 下载gitlab-ce的docker镜像\n\n下载当前最新版本， 最好指明版本号， 如下：\n\n```shell\ndocker pull gitlab/gitlab-ce:13.9.1-ce.0\n```\n\n#### 2. 采用docker compose安装gitlab-ce\n\n配置环境变量`GITLAB_HOME`:\n\n```\nvim ~/.bash_profile\n```\n\n追回内容：\n\n```\nexport GITLAB_HOME=/Users/xx/gitlab\n```\n\n使环境变量生效：\n\n```\nsource ~/.bash_profile\n\nor \n\n# 如果~/.zshrc里配置了source ~/.bash_profile\nsource ~/.zshrc\n```\n\n创建目录：\n\n```\nmkdir -p $GITLAB_HOME/config\n\nmkdir -p $GITLAB_HOME/logs\n\nmkdir -p $GITLAB_HOME/data\n```\n\n`docker-compose.yml`文件内容：\n\n```yml\nversion: '3'\nservices:\n\n  gitlab:\n    image: gitlab/gitlab-ce:13.9.1-ce.0\n    restart: always\n    hostname: gitlab.example.com\n    environment:\n      GITLAB_OMNIBUS_CONFIG: |\n        external_url 'https://gitlab.example.com'\n        # Add any other gitlab.rb configuration here, each on its own line\n    ports:\n      - '80:80'\n      - '443:443'\n      - '22:22'\n    volumes:\n      - '$GITLAB_HOME/config:/etc/gitlab'\n      - '$GITLAB_HOME/logs:/var/log/gitlab'\n      - '$GITLAB_HOME/data:/var/opt/gitlab'\n\n```\n\n本机测试示例：\n\n```\nversion: '3'\nservices:\n\n  gitlab:\n    image: gitlab/gitlab-ce:13.9.1-ce.0\n    container_name: gitlab\n    restart: always\n    hostname: gitlab.zhuxiongxian.com\n    # hostname: gitlab.example.com\n    environment:\n      TZ: 'Asia/Shanghai'\n      GITLAB_OMNIBUS_CONFIG: |\n        external_url 'https://gitlab.zhuxiongxian.com'\n        # gitlab_rails['gitlab_shell_ssh_port'] = 10222\n        gitlab_rails['time_zone'] = 'Asia/Shanghai'\n        # gitlab_rails['time_zone'] = 'PRC'\n        # gitlab_rails['gitlab_email_enabled'] = true\n        # gitlab_rails['gitlab_email_from'] = 'gitlab-no-reply@example.com'\n        # gitlab_rails['gitlab_email_display_name'] = 'GitLab Administrator'\n        # gitlab_rails['gitlab_email_reply_to'] = 'admin@example.com'\n        gitlab_rails['backup_keep_time'] = 14515200\n        # gitlab_rails['smtp_enable'] = true\n        # gitlab_rails['smtp_address'] = \"smtp.example.com\"\n        # gitlab_rails['smtp_port'] = 587\n        # gitlab_rails['smtp_user_name'] = \"no-reply@example.com\"\n        # gitlab_rails['smtp_password'] = \"changeMeToSomethingGood\"\n        # gitlab_rails['smtp_domain'] = \"example.com\"\n        # gitlab_rails['smtp_authentication'] = \"login\"\n        # gitlab_rails['smtp_enable_starttls_auto'] = true\n        # gitlab_rails['smtp_tls'] = true\n        unicorn['worker_timeout'] = 60\n        unicorn['worker_processes'] = 2\n        sidekiq['concurrency'] = 4\n        logrotate['enable'] = true\n        # logging['logrotate_frequency'] = \"weekly\"\n        # logging['logrotate_rotate'] = 52\n        logging['logrotate_frequency'] = \"daily\"\n        logging['logrotate_rotate'] = 30\n        logging['logrotate_compress'] = \"compress\"\n        logging['logrotate_method'] = \"copytruncate\"\n        logging['logrotate_delaycompress'] = \"delaycompress\"\n        nginx['enable'] = true\n        nginx['listen_port'] = 443\n        nginx['redirect_http_to_https'] = true\n        # nginx['ssl_certificate'] = \"/etc/ssl/certs/gitlab/server-cert.pem\"\n        # nginx['ssl_certificate_key'] = \"/etc/ssl/certs/gitlab/server-key.pem\"\n        nginx['ssl_protocols'] = \"TLSv1.1 TLSv1.2\"\n        nginx['logrotate_frequency'] = \"weekly\"\n        nginx['logrotate_rotate'] = 52\n        nginx['logrotate_compress'] = \"compress\"\n        nginx['logrotate_method'] = \"copytruncate\"\n        nginx['logrotate_delaycompress'] = \"delaycompress\"\n        letsencrypt['enable'] = false\n        # Add any other gitlab.rb configuration here, each on its own line\n    # deploy:\n    #   resources:\n    #     limits:\n    #       cpus: '0.1'\n    #       memory: 1g\n    #     reservations:\n    #       cpus: '0.0001'\n    #       memory: 20M\n    ports:\n      - '80:80'\n      - '443:443'\n      - '22:22'\n    volumes:\n      - '$GITLAB_HOME/config:/etc/gitlab'\n      - '$GITLAB_HOME/logs:/var/log/gitlab'\n      - '$GITLAB_HOME/data:/var/opt/gitlab'\n\n```\n\n#### 3. 访问\n\n访问`external_url`配置的地址： https://gitlab.zhuxiongxian.com\n","tags":["docker","git","gitlab"],"categories":["git"]},{"title":"基于docker环境搭建ELK日志分析系统","url":"/2021/03/02/docker-elk/","content":"\n#### 1. 架构\n\n日志统计分析系统采用架构：\n\n```\ndocker + kibana + logstash + elasticsearch + kafka + zookeeper + filebeat\n```\n\n#### 2. 下载docker镜像\n\nhttps://www.elastic.co/guide/index.html\nhttps://www.elastic.co/guide/en/kibana/current/docker.html\nhttps://www.elastic.co/guide/cn/kibana/current/docker.html\nhttps://www.elastic.co/guide/en/beats/filebeat/current/filebeat-installation-configuration.html\n\n```\ndocker pull kibana:7.10.1\ndocker pull logstash:7.10.1\ndocker pull elasticsearch:7.10.1\ndocker pull confluentinc/cp-kafka:6.0.2\ndocker pull confluentinc/cp-zookeeper:6.0.2\n```\n\n#### 3. 默认端口\n\n- kibana端口： 5601\n- logstash端口： 5044\n- elasticsearch端口： 9200\n- kafka端口： 9092\n- zookeeper端口： 2181\n\n#### 4. docker-compose.yml\n\n创建目录：\n\n```\nmkdir -p /Users/xx/elk/elasticsearch/data\nmkdir -p /Users/xx/elk/elasticsearch/plugins\nmkdir -p /Users/xx/elk/logstash/pipeline\nmkdir -p /Users/xx/elk/logstash/patterns\n```\n\ndocker-compose.yml文件内容：\n\n```\nversion: '3'\nservices:\n\n  kibana:\n    image: kibana:7.10.1\n    container_name: kibana\n    hostname: kibana\n    restart: always\n    links:\n      - elasticsearch\n    depends_on:\n      - elasticsearch\n    ports:\n      - 5601:5601\n    environment:\n      TZ: Asia/Shanghai\n      # - elasticsearch.hosts=http://elasticsearch:9200\n      # - I18N_LOCALE=zh-CN\n      # - XPACK_GRAPH_ENABLED=true\n      # - TIMELION_ENABLED=true\n      # - XPACK_MONITORING_COLLECTION_ENABLED=\"true\"\n      # SERVER_NAME: kibana\n      # SERVER_HOST: 0.0.0.0\n      ELASTICSEARCH_HOSTS: http://elasticsearch:9200\n      SERVER_NAME: localhost\n      SERVER_HOST: 0.0.0.0\n      ELASTICSEARCH_URL: http://elasticsearch:9200/\n      I18N_LOCALE: zh-CN\n      XPACK_SECURITY_ENABLED: 'false'\n      MONITORING_ENABLED: 'true'\n    # volumes:\n    #   - /Users/xx/elk/kibana/kibana.yml:/usr/share/kibana/config/kibana.yml\n    # networks:\n    #   - default\n  logstash:\n    image: logstash:7.10.1\n    container_name: logstash\n    hostname: logstash\n    restart: always\n    depends_on:\n      - elasticsearch\n    ports:\n      - 5044:5044\n    links:\n      - elasticsearch\n      - kafka\n    environment:\n      TZ: Asia/Shanghai\n    volumes:\n      - /Users/xx/elk/logstash/pipeline:/usr/share/logstash/pipeline\n      - /Users/xx/elk/logstash/patterns:/usr/share/logstash/patterns\n    # networks:\n    #   - default\n  elasticsearch:\n    image: elasticsearch:7.10.1\n    container_name: elasticsearch\n    hostname: elasticsearch\n    restart: always\n    ulimits:\n      memlock:\n        soft: -1\n        hard: -1\n    environment:\n      TZ: Asia/Shanghai\n      bootstrap.memory_lock: 'true'\n      cluster.name: docker-elk-cluster\n      discovery.type: single-node\n      xpack.security.enabled: 'false'\n      ES_JAVA_OPTS: '-Xms512M -Xmx512M'\n      http.cors.enabled: 'true'\n      http.cors.allow-origin: '*'\n      network.bind_host: 0.0.0.0\n\n      # - bootstrap.memory_lock=true\n      # - cluster.name=docker-elk-cluster\n      # - discovery.type=single-node\n      # - xpack.security.enabled=false\n      # - \"ES_JAVA_OPTS=-Xms512M -Xmx512M\"\n      # - \"ES_JAVA_OPTS=-Xms1g -Xmx1g\"\n      # - http.cors.enabled=true\n      # - http.cors.allow-origin=*\n      # ES_JAVA_OPTS: \"-Xms2g -Xmx2g\"\n      # discovery.type: single-node\n    ports:\n      - 9200:9200\n    volumes:\n      - /Users/xx/elk/elasticsearch/data:/usr/share/elasticsearch/data\n      - /Users/xx/elk/elasticsearch/plugins:/usr/share/elasticsearch/plugins\n    # networks:\n    #   - default\n  kafka:\n    image: confluentinc/cp-kafka:6.0.2\n    container_name: kafka\n    hostname: kafka\n    restart: always\n    depends_on:\n      - zookeeper\n    links:\n      - zookeeper\n    ports:\n      - 9092:9092\n    environment:\n      TZ: Asia/Shanghai\n      KAFKA_BROKER_ID: 1\n      KAFKA_LISTENERS: PLAINTEXT://:9092\n      KAFKA_ADVERTISED_HOST_NAME: kafka\n      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT\n      KAFKA_INTER_BROKER_LISTENER_NAME: PLAINTEXT\n      # KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:29092,PLAINTEXT_HOST://localhost:9092\n      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:9092\n      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181\n      # KAFKA_AUTO_CREATE_TOPICS_ENABLE: 'true'\n      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1\n      KAFKA_HEAP_OPTS: \"-Xmx512M -Xms16M\"\n      # KAFKA_ADVERTISED_PORT: 9092\n      KAFKA_CREATE_TOPICS: \"log:3:3\"\n      KAFKA_AUTO_CREATE_TOPICS_ENABLE: 'false'\n    # volumes:\n    #   - /etc/timezone:/etc/timezone\n    #   - /etc/localtime:/etc/localtime\n    # networks:\n    #   - default\n  zookeeper:\n    image: confluentinc/cp-zookeeper:6.0.2\n    container_name: zookeeper\n    hostname: zookeeper\n    restart: always\n    ports:\n      - 2181:2181\n    environment:\n      TZ: Asia/Shanghai\n      ZOOKEEPER_CLIENT_PORT: 2181\n      ZOOKEEPER_TICK_TIME: 2000\n    # networks:\n    #   - default\n\nnetworks:\n  default:\n    driver: bridge\n\n```\n\n#### 5. 一键构建\n\n后台启动，如果容器不存在根据镜像自动创建:\n\n```\ndocker-compose up -d\n```\n\n停止容器并删除容器:\n\n```\ndocker-compose down -v\n```\n\n启动集群容器，容器不存在就无法启动:\n\n```\ndocker-compose start\n```\n\n停止集群容器:\n\n```\ndocker-compose stop\n```\n\n重启集群容器:\n\n```\ndocker-compose restart\n```\n\n查看集群容器状态:\n\n```\ndocker-compose ps\n```\n\n查看日志：\n\n```\ndocker-compose logs\n```\n\n#### 6. 访问\n\nkibana访问：http://127.0.0.1:5601\n\nelasticsearch访问: http://127.0.0.1:9200\n\nhttp://localhost:9200/_nodes?pretty=true\n","tags":["docker","ELK","kibana"],"categories":["docker"]},{"title":"mysql5.7安装密码校验插件validate_password","url":"/2021/02/28/mysql5-7-install-password-verification-plug-in-validate-password/","content":"\n#### 1. 查看密码校验插件validate_password是否启用\n\n插件文件名称用\n\nfor linux or mac:\n\n```\nvalidate_password.so\n```\n\nfor windows:\n\n```\nvalidate_password.dll\n```\n\nmysql命令连接mysql shell:\n\n不使用ssl连接示例：\n\n```\nmysql -uroot -p\n```\n\n使用ssl连接示例：\n\n```\nmysql -uroot -p --ssl-ca=/usr/local/mysql/data/ca-cert.pem --ssl-cert=/usr/local/mysql/data/client-cert.pem --ssl-key=/usr/local/mysql/data/client-key.pem\n```\n\n查看所有插件及查看密码校验插件是否启用：\n\n```\nmysql> show plugins;\nmysql> show variables like 'validate_password%';\n+--------------------------------------+--------+\n| Variable_name | Value |\n+--------------------------------------+--------+\n| validate_password_check_user_name | OFF |\n| validate_password_dictionary_file | |\n| validate_password_length | 8 |\n| validate_password_mixed_case_count | 1 |\n| validate_password_number_count | 1 |\n| validate_password_policy | MEDIUM |\n| validate_password_special_char_count | 1 |\n+--------------------------------------+--------+\n7 rows in set (0.01 sec)\n```\n\n若插件列表没有`validate_password`及mysql环境变量没有以上信息， 则说明没有启用`validate_password`插件。\n\n#### 2. 查看mysql插件目录路径\n\n查看插件目录路径：\n\n```\nmysql> show variables like 'plugin_dir';\n+---------------+------------------------------+\n| Variable_name | Value |\n+---------------+------------------------------+\n| plugin_dir | /usr/local/mysql/lib/plugin/ |\n+---------------+------------------------------+\n1 row in set (0.02 sec)\n```\n\n可知我的mysql插件目录路径为`/usr/local/mysql/lib/plugin/`\n\n查看mysql插件目录下内容：\n\n```\ncd /usr/local/mysql/lib/plugin/\nls -la\n```\n\n发现mysql密码校验插件`validate_password.so`， 显示插件是存在的， 只是尚未启用。\n\n#### 3. 启用密码校验插件validate_password\n\n修改mysql配置文件：\n\n```bash\nvim /etc/my.cnf\n```\n\n追加以下内容：\n\n```\n[mysqld]\nplugin-load-add = validate_password.so\n# 服务器在启动时加载插件，并防止在服务器运行时删除插件。\nvalidate-password = FORCE_PLUS_PERMANENT\n```\n\n本人当前的`/etc/my.cnf`文件内容参考示例：\n\n```\n[mysqld]\ncharacter-set-client-handshake = FALSE\ncharacter-set-server = utf8mb4\ncollation-server = utf8mb4_unicode_ci\ninit_connect = 'SET NAMES utf8mb4'\nssl-ca = ca-cert.pem\nssl-cert = server-cert.pem\nssl-key = server-key.pem\nplugin-load-add = validate_password.so\n# 服务器在启动时加载插件，并防止在服务器运行时删除插件。\nvalidate-password = FORCE_PLUS_PERMANENT\n\n[mysql]\ndefault-character-set = utf8mb4\n\n[client]\ndefault-character-set = utf8mb4\n```\n\n修改my.cnf后，重启mysql服务以使设置生效。\n或者，要在运行时注册插件，可以使用以下语句(根据系统需要调整.so或.dll后缀):\n\n```\nmysql> INSTALL PLUGIN validate_password SONAME 'validate_password.so';\n```\n\n#### 4. 查看mysql密码校验插件validate_password状态\n\n```\nmysql> show plugins;\n\nmysql> show variables like 'validate_password%';\n+--------------------------------------+--------+\n| Variable_name | Value |\n+--------------------------------------+--------+\n| validate_password_check_user_name | OFF |\n| validate_password_dictionary_file | |\n| validate_password_length | 8 |\n| validate_password_mixed_case_count | 1 |\n| validate_password_number_count | 1 |\n| validate_password_policy | MEDIUM |\n| validate_password_special_char_count | 1 |\n+--------------------------------------+--------+\n7 rows in set (0.01 sec)\n\nmysql> SHOW STATUS LIKE 'validate_password%';\n+-----------------------------------------------+---------------------+\n| Variable_name | Value |\n+-----------------------------------------------+---------------------+\n| validate_password_dictionary_file_last_parsed | 2021-02-28 05:49:23 |\n| validate_password_dictionary_file_words_count | 0 |\n+-----------------------------------------------+---------------------+\n2 rows in set (0.01 sec)\n\n```\n\n#### 5. 测试密码校验策略\n\n测试, (当前默认策略：validate_password_policy=MEDIUM):\n\n```\nmysql> create user test@'localhost' identified by '123456';\nERROR 1819 (HY000): Your password does not satisfy the current policy requirements\nmysql> create user test@'localhost' identified by 'Mysql_123456';\nQuery OK, 0 rows affected (0.00 sec)\n\n```\n\n经检测发现， 对已存在账号的密码没有限制。\n","tags":["mysql","validate_password","复杂度"],"categories":["mysql"]},{"title":"docker命令","url":"/2020/05/11/docker-commands/","content":"\n#### 1. docker信息\n\n```\ndocker info\n```\n\n#### 2. docker, compose和machine版本信息\n\n```\ndocker --version\ndocker verison\ndocker-compose --version\ndocker-machine --version\n```\n\n#### 3. 列出本地镜像\n\n```\ndocker images\n```\n\n#### 4. 列出所有正在运行的容器\n\n```\ndocker ps\n\nor\n\ndocker container ls\n```\n\n#### 5. 列出所有容器及显示容器大小\n\n```\ndocker ps -as\n\nor\n\ndocker container ls -as\n```\n\n参数`-s`显示容器大小， `-a`显示所有容器\n\n#### 6. 列出所有容器\n\n```\ndocker ps -a\n\nor\n\ndocker container ls -a\n```\n\n#### 7. 进入一个正在运行的容器\n\n```\ndocker exec -it 容器名 /bin/sh\n\nor\n\ndocker exec -it 容器短UUID /bin/sh\n\nor\n\ndocker exec -it 容器长UUID /bin/sh\n```\n\n注意， `/bin/sh`若找不到， 可替换为`/bin/bash`或`bash`或`sh`， 下同\n\n#### 8. 退出所在运行的容器\n\n`exit`命令即可退出\n\n```\n/ # exit\n```\n\n#### 9. 运行docker run hello-world以测试从Docker Hub中拉取图像并启动容器\n\n```\ndocker run hello-world\n```\n\n#### 10. 运行一个Ubuntu容器\n\n```\ndocker run -it ubuntu bash\n```\n\n#### 11. 通过镜像创建新容器\n\n`docker run --name 容器名 镜像名`\n\n```\ndocker run --name alpineappbase alpine\n```\n\n若容器已创建过， 则会报容器已存在的错误， 如：\n\n```\ndocker: Error response from daemon: Conflict. The container name \"/alpineappbase\" is already in use by container \"7b32b8c559618c677f50ab793d70e4d08dda3499c3b13d82cb118aa1e6e91e1a\". You have to remove (or rename) that container to be able to reuse that name.\n```\n\n#### 12. 启动已创建的容器\n\n`docker start 容器名/容器短UUID/容器长UUID`\n\n```\ndocker start alpineappbase\n\nor\n\ndocker start 7b32b8c55961\n\nor\n\ndocker start 7b32b8c559618c677f50ab793d70e4d08dda3499c3b13d82cb118aa1e6e91e1a\n```\n\n#### 13. 停止一个运行中的容器\n\n`docker stop 容器名/容器短UUID/容器长UUID`\n\n```\ndocker stop alpineappbase\n\nor\n\ndocker stop 7b32b8c55961\n\nor\n\ndocker stop 7b32b8c559618c677f50ab793d70e4d08dda3499c3b13d82cb118aa1e6e91e1a\n```\n\n其中， `7b32b8c55961`是`docker ps`中的`CONTAINER ID`, 是短UUID， 对应的长UUID为`7b32b8c559618c677f50ab793d70e4d08dda3499c3b13d82cb118aa1e6e91e1a`\n\n#### 14. 删除容器\n\n```\ndocker rm 容器名/容器短UUID/容器长UUID\n```\n\n#### 15. 从Docker Hub中拉取或者更新指定镜像\n\n```\ndocker pull 镜像名\n```\n\n#### 16. 从Docker Hub中搜索符合条件的镜像\n\n```\ndocker search 镜像名\n```\n\n#### 17. 从本地移除一个或多个指定的镜像\n\n```\ndocker rmi 镜像名1 镜像名2 ...\n```\n\n`-f`： 强行移除该镜像，即使其正被使用；\n`--no-prune`： 不移除该镜像的过程镜像，默认移除。\n\n#### 18. 查看容器内的进程\n\n```\ndocker top 容器ID\n```\n\n如： docker top ee40883460d7\n\n其中PID是容器内进程在宿主机上的pid，ppid是容器内进程在宿主机上的父进程pid\n\n#### 19. 查看镜像或容器详情\n\n```\ndocker inspect 镜像ID/容器ID\n```\n","tags":["docker","命令"],"categories":["docker"]},{"title":"docker的安装","url":"/2020/05/11/installation-of-docker/","content":"\n#### 1. linux下安装docker\n\n`for centos`:\n\nhttps://docs.docker.com/engine/install/centos/\n\n卸载旧版本docker:\n\n```\n$ sudo yum remove docker \\\n                  docker-client \\\n                  docker-client-latest \\\n                  docker-common \\\n                  docker-latest \\\n                  docker-latest-logrotate \\\n                  docker-logrotate \\\n                  docker-engine\n```\n\n使用docker仓库进行安装:\n\n```\n$ sudo yum install -y yum-utils\n```\n\n官方源：\n\n```\n$ sudo yum-config-manager \\\n    --add-repo \\\n    https://download.docker.com/linux/centos/docker-ce.repo\n```\n\n阿里云docker源：\n\n```\n$ sudo yum-config-manager \\\n    --add-repo \\\n    http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n```\n\n安装`docker engine`:\n\n```\n$ sudo yum install docker-ce docker-ce-cli containerd.io\n```\n\n开启docker服务：\n\n```\n$ sudo systemctl start docker\n```\n\n卸载`docker engine`：\n\n```\n$ sudo yum remove docker-ce docker-ce-cli containerd.io\n```\n\n\n\n#### 2. mac下安装docker\n\nhttps://docs.docker.com/desktop/install/mac-install/\n\n#### 3. windwos下安装docker\n","tags":["docker","安装"],"categories":["docker"]},{"title":"解决macos下安装m2crypto报SWIG的错","url":"/2020/03/06/install-m2crypto-on-macosx/","content":"\n#### 1. 使用pipenv或pip在虚拟环境安装m2crypto报错\n\n使用pipenv或pip在虚拟环境安装m2crypto报错， 报错内容如下：\n\n```\n(env)$ pipenv install m2crypto       # 或： (env)$ pip install m2crypto\nInstalling initially failed dependencies…\n[pipenv.exceptions.InstallError]:   File \"/usr/local/lib/python3.7/site-packages/pipenv/core.py\", line 1874, in do_install\n[pipenv.exceptions.InstallError]:       keep_outdated=keep_outdated\n[pipenv.exceptions.InstallError]:   File \"/usr/local/lib/python3.7/site-packages/pipenv/core.py\", line 1253, in do_init\n[pipenv.exceptions.InstallError]:       pypi_mirror=pypi_mirror,\n[pipenv.exceptions.InstallError]:   File \"/usr/local/lib/python3.7/site-packages/pipenv/core.py\", line 859, in do_install_dependencies\n[pipenv.exceptions.InstallError]:       retry_list, procs, failed_deps_queue, requirements_dir, **install_kwargs\n[pipenv.exceptions.InstallError]:   File \"/usr/local/lib/python3.7/site-packages/pipenv/core.py\", line 763, in batch_install\n[pipenv.exceptions.InstallError]:       _cleanup_procs(procs, not blocking, failed_deps_queue, retry=retry)\n[pipenv.exceptions.InstallError]:   File \"/usr/local/lib/python3.7/site-packages/pipenv/core.py\", line 681, in _cleanup_procs\n[pipenv.exceptions.InstallError]:       raise exceptions.InstallError(c.dep.name, extra=err_lines)\n[pipenv.exceptions.InstallError]: ['Looking in indexes: http://mirrors.aliyun.com/pypi/simple/', 'Collecting m2crypto==0.35.2', '  Downloading http://mirrors.aliyun.com/pypi/packages/74/18/3beedd4ac48b52d1a4d12f2a8c5cf0ae342ce974859fba838cbbc1580249/M2Crypto-0.35.2.tar.gz (1.1 MB)', 'Building wheels for collected packages: m2crypto', '  Building wheel for m2crypto (setup.py): started', \"  Building wheel for m2crypto (setup.py): finished with status 'error'\", '  Running setup.py clean for m2crypto', 'Failed to build m2crypto', 'Installing collected packages: m2crypto', '    Running setup.py install for m2crypto: started', \"    Running setup.py install for m2crypto: finished with status 'error'\"]\n[pipenv.exceptions.InstallError]: ['ERROR: Command errored out with exit status 1:', '   command: /Users/xx/.local/share/virtualenvs/iHealth-WeChat-UB3mZpIa/bin/python -u -c \\'import sys, setuptools, tokenize; sys.argv[0] = \\'\"\\'\"\\'/private/var/folders/v8/hycw3b7x5vz3yv_lsxvg9fym0000gn/T/pip-install-06p4c1dw/m2crypto/setup.py\\'\"\\'\"\\'; __file__=\\'\"\\'\"\\'/private/var/folders/v8/hycw3b7x5vz3yv_lsxvg9fym0000gn/T/pip-install-06p4c1dw/m2crypto/setup.py\\'\"\\'\"\\';f=getattr(tokenize, \\'\"\\'\"\\'open\\'\"\\'\"\\', open)(__file__);code=f.read().replace(\\'\"\\'\"\\'\\\\r\\\\n\\'\"\\'\"\\', \\'\"\\'\"\\'\\\\n\\'\"\\'\"\\');f.close();exec(compile(code, __file__, \\'\"\\'\"\\'exec\\'\"\\'\"\\'))\\' bdist_wheel -d /private/var/folders/v8/hycw3b7x5vz3yv_lsxvg9fym0000gn/T/pip-wheel-vuqvb4mq', '       cwd: /private/var/folders/v8/hycw3b7x5vz3yv_lsxvg9fym0000gn/T/pip-install-06p4c1dw/m2crypto/', '  Complete output (55 lines):', '  running bdist_wheel', '  running build', '  running build_py', '  copying M2Crypto/callback.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/EVP.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/AuthCookie.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/m2.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/ftpslib.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/EC.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/httpslib.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/X509.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/util.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/RSA.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/BIO.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/DH.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/__init__.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/threading.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/Rand.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/SMIME.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/Engine.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/m2xmlrpclib.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/RC4.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/m2urllib2.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/DSA.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/six.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/m2urllib.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/BN.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/m2crypto.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/Err.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  copying M2Crypto/ASN1.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '  creating build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '  copying M2Crypto/SSL/cb.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '  copying M2Crypto/SSL/Session.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '  copying M2Crypto/SSL/timeout.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '  copying M2Crypto/SSL/__init__.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '  copying M2Crypto/SSL/TwistedProtocolWrapper.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '  copying M2Crypto/SSL/Cipher.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '  copying M2Crypto/SSL/Connection.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '  copying M2Crypto/SSL/Context.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '  copying M2Crypto/SSL/SSLServer.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '  copying M2Crypto/SSL/ssl_dispatcher.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '  copying M2Crypto/SSL/Checker.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '  warning: build_py: byte-compiling is disabled, skipping.', '  ', '  running build_ext', \"  building 'M2Crypto._m2crypto' extension\", '  swigging SWIG/_m2crypto.i to SWIG/_m2crypto_wrap.c', '  swig -python -py3 -I/Users/xx/.local/share/virtualenvs/iHealth-WeChat-UB3mZpIa/include -I/usr/local/python3.6/include/python3.6m -I/usr/include/openssl -I/usr/local/include -I/Library/Developer/CommandLineTools/usr/lib/clang/11.0.0/include -I/Library/Developer/CommandLineTools/usr/include -I/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include -I/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/System/Library/Frameworks (framework directory) -I/usr/local/include -I/Library/Developer/CommandLineTools/usr/lib/clang/11.0.0/include -I/Library/Developer/CommandLineTools/usr/include -I/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include -I/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/System/Library/Frameworks (framework directory) -includeall -modern -builtin -outdir /private/var/folders/v8/hycw3b7x5vz3yv_lsxvg9fym0000gn/T/pip-install-06p4c1dw/m2crypto/M2Crypto -o SWIG/_m2crypto_wrap.c SWIG/_m2crypto.i', '  Deprecated command line option: -modern. This option is now always on.', \"  SWIG/_m2crypto.i:62: Error: Unable to find 'openssl/opensslv.h'\", \"  SWIG/_m2crypto.i:68: Error: Unable to find 'openssl/safestack.h'\", \"  SWIG/_evp.i:12: Error: Unable to find 'openssl/opensslconf.h'\", \"  SWIG/_rc4.i:5: Error: Unable to find 'openssl/opensslconf.h'\", \"  SWIG/_ec.i:7: Error: Unable to find 'openssl/opensslconf.h'\", \"  error: command 'swig' failed with exit status 1\", '  ----------------------------------------', '  ERROR: Failed building wheel for m2crypto', '    ERROR: Command errored out with exit status 1:', '     command: /Users/xx/.local/share/virtualenvs/iHealth-WeChat-UB3mZpIa/bin/python -u -c \\'import sys, setuptools, tokenize; sys.argv[0] = \\'\"\\'\"\\'/private/var/folders/v8/hycw3b7x5vz3yv_lsxvg9fym0000gn/T/pip-install-06p4c1dw/m2crypto/setup.py\\'\"\\'\"\\'; __file__=\\'\"\\'\"\\'/private/var/folders/v8/hycw3b7x5vz3yv_lsxvg9fym0000gn/T/pip-install-06p4c1dw/m2crypto/setup.py\\'\"\\'\"\\';f=getattr(tokenize, \\'\"\\'\"\\'open\\'\"\\'\"\\', open)(__file__);code=f.read().replace(\\'\"\\'\"\\'\\\\r\\\\n\\'\"\\'\"\\', \\'\"\\'\"\\'\\\\n\\'\"\\'\"\\');f.close();exec(compile(code, __file__, \\'\"\\'\"\\'exec\\'\"\\'\"\\'))\\' install --record /private/var/folders/v8/hycw3b7x5vz3yv_lsxvg9fym0000gn/T/pip-record-mk0tmw37/install-record.txt --single-version-externally-managed --compile --install-headers /Users/xx/.local/share/virtualenvs/iHealth-WeChat-UB3mZpIa/include/site/python3.6/m2crypto', '         cwd: /private/var/folders/v8/hycw3b7x5vz3yv_lsxvg9fym0000gn/T/pip-install-06p4c1dw/m2crypto/', '    Complete output (58 lines):', '    running install', '    running build', '    running build_py', '    creating build', '    creating build/lib.macosx-10.15-x86_64-3.6', '    creating build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/callback.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/EVP.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/AuthCookie.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/m2.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/ftpslib.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/EC.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/httpslib.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/X509.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/util.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/RSA.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/BIO.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/DH.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/__init__.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/threading.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/Rand.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/SMIME.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/Engine.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/m2xmlrpclib.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/RC4.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/m2urllib2.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/DSA.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/six.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/m2urllib.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/BN.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/m2crypto.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/Err.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    copying M2Crypto/ASN1.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto', '    creating build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '    copying M2Crypto/SSL/cb.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '    copying M2Crypto/SSL/Session.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '    copying M2Crypto/SSL/timeout.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '    copying M2Crypto/SSL/__init__.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '    copying M2Crypto/SSL/TwistedProtocolWrapper.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '    copying M2Crypto/SSL/Cipher.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '    copying M2Crypto/SSL/Connection.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '    copying M2Crypto/SSL/Context.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '    copying M2Crypto/SSL/SSLServer.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '    copying M2Crypto/SSL/ssl_dispatcher.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '    copying M2Crypto/SSL/Checker.py -> build/lib.macosx-10.15-x86_64-3.6/M2Crypto/SSL', '    warning: build_py: byte-compiling is disabled, skipping.', '    ', '    running build_ext', \"    building 'M2Crypto._m2crypto' extension\", '    swigging SWIG/_m2crypto.i to SWIG/_m2crypto_wrap.c', '    swig -python -py3 -I/Users/xx/.local/share/virtualenvs/iHealth-WeChat-UB3mZpIa/include -I/usr/local/python3.6/include/python3.6m -I/usr/include/openssl -I/usr/local/include -I/Library/Developer/CommandLineTools/usr/lib/clang/11.0.0/include -I/Library/Developer/CommandLineTools/usr/include -I/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include -I/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/System/Library/Frameworks (framework directory) -I/usr/local/include -I/Library/Developer/CommandLineTools/usr/lib/clang/11.0.0/include -I/Library/Developer/CommandLineTools/usr/include -I/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include -I/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/System/Library/Frameworks (framework directory) -includeall -modern -builtin -outdir /private/var/folders/v8/hycw3b7x5vz3yv_lsxvg9fym0000gn/T/pip-install-06p4c1dw/m2crypto/M2Crypto -o SWIG/_m2crypto_wrap.c SWIG/_m2crypto.i', '    Deprecated command line option: -modern. This option is now always on.', \"    SWIG/_m2crypto.i:62: Error: Unable to find 'openssl/opensslv.h'\", \"    SWIG/_m2crypto.i:68: Error: Unable to find 'openssl/safestack.h'\", \"    SWIG/_evp.i:12: Error: Unable to find 'openssl/opensslconf.h'\", \"    SWIG/_rc4.i:5: Error: Unable to find 'openssl/opensslconf.h'\", \"    SWIG/_ec.i:7: Error: Unable to find 'openssl/opensslconf.h'\", \"    error: command 'swig' failed with exit status 1\", '    ----------------------------------------', 'ERROR: Command errored out with exit status 1: /Users/xx/.local/share/virtualenvs/iHealth-WeChat-UB3mZpIa/bin/python -u -c \\'import sys, setuptools, tokenize; sys.argv[0] = \\'\"\\'\"\\'/private/var/folders/v8/hycw3b7x5vz3yv_lsxvg9fym0000gn/T/pip-install-06p4c1dw/m2crypto/setup.py\\'\"\\'\"\\'; __file__=\\'\"\\'\"\\'/private/var/folders/v8/hycw3b7x5vz3yv_lsxvg9fym0000gn/T/pip-install-06p4c1dw/m2crypto/setup.py\\'\"\\'\"\\';f=getattr(tokenize, \\'\"\\'\"\\'open\\'\"\\'\"\\', open)(__file__);code=f.read().replace(\\'\"\\'\"\\'\\\\r\\\\n\\'\"\\'\"\\', \\'\"\\'\"\\'\\\\n\\'\"\\'\"\\');f.close();exec(compile(code, __file__, \\'\"\\'\"\\'exec\\'\"\\'\"\\'))\\' install --record /private/var/folders/v8/hycw3b7x5vz3yv_lsxvg9fym0000gn/T/pip-record-mk0tmw37/install-record.txt --single-version-externally-managed --compile --install-headers /Users/xx/.local/share/virtualenvs/iHealth-WeChat-UB3mZpIa/include/site/python3.6/m2crypto Check the logs for full command output.']\nERROR: ERROR: Package installation failed...\n```\n\n#### 2. 解决方法\n\n先安装`openssl`和`swig`:\n\n```\nbrew install openssl\nbrew install swig\n```\n\n可以查看`openssl`安装目录：\n\n```\n$ brew --prefix openssl\n/usr/local/opt/openssl@1.1\n$ ll /usr/local/opt/openssl@1.1\nlrwxr-xr-x  1 xx  admin    28B 10  4 15:01 /usr/local/opt/openssl@1.1 -> ../Cellar/openssl@1.1/1.1.1d\n```\n\n可以知道openssl的实际安装目录是 /usr/local/Cellar/openssl@1\\.1/1\\.1\\.1d/， /usr/local/opt/openssl@1\\.1 只是 /usr/local/Cellar/openssl@1\\.1/1\\.1\\.1d/ 一个软链接， 得知 `/usr/local/opt/` 下存放的都是一些软链接。\n\n在`/usr/local/include/`目录下创建`openssl`的软链接：\n\n```\nsudo ln -s /usr/local/opt/openssl@1.1/include/openssl /usr/local/include/openssl\n```\n\n在`/usr/local/lib/`目录下创建`libssl.dylib`和`libcrypto.dylib`的软链接：\n\n```\nsudo ln -s /usr/local/opt/openssl@1.1/lib/libssl.dylib /usr/local/lib/libssl.dylib\nsudo ln -s /usr/local/opt/openssl@1.1/lib/libcrypto.dylib /usr/local/lib/libcrypto.dylib\n```\n\n然后重新安装`m2crypto`即可安装成功:\n\n```\n(env)$ pipenv install m2crypto       # 或： (env)$ pip install m2crypto\n```\n\n","tags":["python","mac","m2crypto","swig"],"categories":["python"]},{"title":"mysql5.7.x编码设置为utf8mb4","url":"/2020/02/12/mysql5-7-x-encoding-is-set-to-utf8mb4/","content":"\n#### 1.  临时设置编码(重新进入mysql shell后失效)\n\n```\nmysql> show variables like '%char%';\n+--------------------------+-----------------------------------------------------------+\n| Variable_name | Value |\n+--------------------------+-----------------------------------------------------------+\n| character_set_client | utf8 |\n| character_set_connection | utf8 |\n| character_set_database | latin1 |\n| character_set_filesystem | binary |\n| character_set_results | utf8 |\n| character_set_server | latin1 |\n| character_set_system | utf8 |\n| character_sets_dir | /usr/local/mysql-5.7.28-macos10.14-x86_64/share/charsets/ |\n+--------------------------+-----------------------------------------------------------+\n8 rows in set (0.00 sec)\n\nmysql> set character_set_client=utf8mb4;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> set character_set_connection=utf8mb4;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> set character_set_database=utf8mb4;\nQuery OK, 0 rows affected, 1 warning (0.00 sec)\n\nmysql> set character_set_results=utf8mb4;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> set character_set_server=utf8mb4;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> show variables like '%char%';\n+--------------------------+-----------------------------------------------------------+\n| Variable_name | Value |\n+--------------------------+-----------------------------------------------------------+\n| character_set_client | utf8mb4 |\n| character_set_connection | utf8mb4 |\n| character_set_database | utf8mb4 |\n| character_set_filesystem | binary |\n| character_set_results | utf8mb4 |\n| character_set_server | utf8mb4 |\n| character_set_system | utf8 |\n| character_sets_dir | /usr/local/mysql-5.7.28-macos10.14-x86_64/share/charsets/ |\n+--------------------------+-----------------------------------------------------------+\n8 rows in set (0.00 sec)\n```\n\n#### 2. 永久设置编码\n\n在/etc/my.cnf文件中修改：\n\n```\n[mysqld]\ncharacter-set-client-handshake = FALSE\ncharacter-set-server = utf8mb4\ncollation-server = utf8mb4_unicode_ci\ninit_connect = 'SET NAMES utf8mb4'\n\n[mysql]\ndefault-character-set = utf8mb4\n\n[client]\ndefault-character-set = utf8mb4\n```\n\n重启mysql服务生效。\n\n#### 3. 查看编码及编码集\n\n```\nmysql> show variables where variable_name like '%char%' or variable_name like 'collation%';\n+--------------------------+-----------------------------------------------------------+\n| Variable_name | Value |\n+--------------------------+-----------------------------------------------------------+\n| character_set_client | utf8mb4 |\n| character_set_connection | utf8mb4 |\n| character_set_database | utf8mb4 |\n| character_set_filesystem | binary |\n| character_set_results | utf8mb4 |\n| character_set_server | utf8mb4 |\n| character_set_system | utf8 |\n| character_sets_dir | /usr/local/mysql-5.7.28-macos10.14-x86_64/share/charsets/ |\n| collation_connection | utf8mb4_unicode_ci |\n| collation_database | utf8mb4_unicode_ci |\n| collation_server | utf8mb4_unicode_ci |\n+--------------------------+-----------------------------------------------------------+\n11 rows in set (0.00 sec)\n\nmysql>\n```\n\n#### 4. 修改已有数据库或表的编码及编码集\n\n```\n# 修改数据库\nmysql> ALTER DATABASE database_name CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci;\n\n# 修改表\nmysql> ALTER TABLE table_name CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;\n\n# 修改表字段\nmysql> ALTER TABLE table_name CHANGE column_name column_name VARCHAR(191) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;\n```","tags":["mysql","编码","utfmb4"],"categories":["git"]},{"title":"mac os x从源码编译安装python3.8","url":"/2019/10/15/install-python3-8-from-source-on-macosx/","content":"\n#### 1. 下载并解压python3.8源码包\n\nhttps://www.python.org/\nhttps://www.python.org/downloads/\n\n选择`XZ compressed source tarball`， 拷贝文件绝对路径链接， 用wget命令下载\n\n```\nwget -c https://www.python.org/ftp/python/3.8.0/Python-3.8.0.tar.xz\nxz -d Python-3.8.0.tar.xz\ntar -xvf Python-3.8.0.tar\n```\n\n#### 2. 安装依赖\n\n##### 2.1. 安装sqlite3\n\nhttp://www.sqlite.org/\n\n```\nwget -c https://www.sqlite.org/2019/sqlite-autoconf-3280000.tar.gz\n./configure --prefix=/usr/local/\nmake\nmake install\n```\n\n##### 2.2. 安装ssl\n\n```\nbrew install zlib openssl\nln -s /usr/local/Cellar/zlib/1.2.11/include/* /usr/local/include\nln -s /usr/local/Cellar/zlib/1.2.11/lib/* /usr/local/lib\n```\n\n#### 3. 支持ssl\n\n```\ncd Python-3.8.0/Modules\nvim Setup\n```\n\n搜索：\n\n```\n:/ssl\n```\n\n将以下内容取消注释:\n\n```\n# Socket module helper for socket(2)\n#_socket socketmodule.c\n\n# Socket module helper for SSL support; you must comment out the other\n# socket line above, and possibly edit the SSL variable:\n#SSL=/usr/local/ssl\n#_ssl _ssl.c \\\n#   -DUSE_SSL -I$(SSL)/include -I$(SSL)/include/openssl \\\n#   -L$(SSL)/lib -lssl -lcrypto\n```\n\n取消注释如下：\n\n```\n# Socket module helper for socket(2)\n_socket socketmodule.c\n\n# Socket module helper for SSL support; you must comment out the other\n# socket line above, and possibly edit the SSL variable:\n#SSL=/usr/local/ssl\n_ssl _ssl.c \\\n    -DUSE_SSL -I$(SSL)/include -I$(SSL)/include/openssl \\\n    -L$(SSL)/lib -lssl -lcrypto\n```\n\n#### 4. 编译安装\n\n指定安装目录：\n\n```\n./configure --prefix=/usr/local/python3.8 --enable-loadable-sqlite-extensions\n```\n\n或:\n\n优化选项安装(可选), 执行完上一步后会提示执行以下的代码对Python解释器进行优化，执行该代码后，会编译安装到 `/usr/local/bin/` 下，且不用添加软连接或环境变量， 如下：\n\n```\nIf you want a release build with all stable optimizations active (PGO, etc),\nplease run ./configure --enable-optimizations\n\n# ./configure --enable-optimizations\n```\n\n编译安装：\n\n```\nmake\nsudo make install\n```\n\n#### 5. 创建软链接\n\n```\nsudo ln -s /usr/local/python3.8/bin/python3.8 /usr/bin/python3.8\n```\n\n#### 6. 检测\n\n```\n$ python3.8\nPython 3.8.0 (default, Oct 15 2019, 15:00:48)\n[Clang 10.0.1 (clang-1001.0.46.4)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import ssl\n>>>\n```\n","tags":["python","mac"],"categories":["python"]},{"title":"postgresql命令","url":"/2019/08/26/postgresql-commands/","content":"\n#### 1. postgresql常用命令\n\n进入数据库`postgres`:\n\n```\n$ psql postgres\n\npsql (11.2)\nType \"help\" for help.\n\npostgres=# \n```\n\n退出postgresql shell:\n\n```\npostgres=# exit\n```\n\n创建用户`olddriver`:\n\n```\npostgres=# create user olddriver with password '123456';\nCREATE ROLE\n```\n\n删除用户`oldriver`， 并创建用户`olddriver`， 将数据库的拥有者修改为`olddriver`:\n\n```\npostgres=# drop role oldriver;\nERROR:  role \"oldriver\" cannot be dropped because some objects depend on it\nDETAIL:  privileges for database postgres\npostgres=# revoke all on database didi from oldriver;\nREVOKE\npostgres=# drop role oldriver;\nERROR:  role \"oldriver\" cannot be dropped because some objects depend on it\nDETAIL:  owner of database didi\npostgres=# create user olddriver with password '123456';\nCREATE ROLE\npostgres=# alter database didi owner to olddriver;\nALTER DATABASE\npostgres=# drop role oldriver;\nDROP ROLE\npostgres=# \n```\n\n创建数据库`didi`:\n\n```\npostgres=# create database didi owner olddriver;\nCREATE DATABASE\n```\n\n修改数据库`didi`的拥有者为`dicar`:\n\n```\npostgres=# alter database didi owner to dicar;\nALTER DATABASE\n```\n","tags":["数据库","postgresql"],"categories":["postgresql"]},{"title":"mac os x sublime text 3安装ctags插件实现代码跳转","url":"/2019/05/21/Mac-OS-X-sublime-text-3-installs-ctags-plug-in-to-achieve-code-jump/","content":"\nctags是一款实现代码跳转的插件，可以提高查看代码的效率.\n\n#### 1. st3安装ctags插件\n\n快捷键`commands + shift + p` 打开 `Package Control: Instance Package`， 搜索 `ctags`进行安装`ctags`插件\n\n#### 2. 安装ctags\n\n打开ctags网址下载ctags源码包： http://ctags.sourceforge.net/\n\n或`wget`命令下载：\n\n```\nwget -c https://jaist.dl.sourceforge.net/project/ctags/ctags/5.8/ctags-5.8.tar.gz\n```\n\n安装ctags：\n\n```\ntar -xzvf ctags-5.8.tar.gz\ncd ctags-5.8/\n./configure\nmake && sudo make install\n```\n\n#### 3. 在st3配置ctags插件\n\n依次打开`Sublime Text -- Preferences -- Package Settings -- CTags -- Settings User`, 拷贝以下内容保存.\n\n```\n{\n    \"command\": \"/usr/local/bin/ctags\",\n}\n```\n\n依次打开`Sublime Text -- Preferences -- Package Settings -- CTags -- Mouse Bindings User`, 拷贝以下内容保存.\n\n默认：\n\n - 按快捷键`ctrl + shift + 鼠标左键` 代码跳转到函数定义 \n - 按快捷键`ctrl + shift + 鼠标右键` 代码跳转到函数引用\n\n改键后：\n\n - 按快捷键`ctrl + 鼠标左键` 代码跳转到函数定义 \n - 按快捷键`ctrl + 鼠标右键` 代码跳转到函数引用\n\n```\n[\n    {\n        \"button\": \"button1\",\n        \"count\": 1,\n        \"press_command\": \"drag_select\",\n        \"modifiers\": [\"ctrl\"],\n        \"command\": \"navigate_to_definition\"\n    },\n    {\n        \"button\": \"button2\",\n        \"count\": 1,\n        \"modifiers\": [\"ctrl\"],\n        \"command\": \"jump_prev\"\n    }\n]\n```\n\n#### 4. ctags自带其他快捷键\n\n- `ctrl + k + u`或`ctrl+k, ctrl+u`将选择代码全部大写\n- `ctrl + k + l`或`ctrl+k, ctrl+l`将选择代码全部小写\n","tags":["mac","sublime text 3","ctags","代码跳转"],"categories":["sublimetext3"]},{"title":"linux下安装postgresql","url":"/2019/02/26/install-postgresql-on-linux/","content":"\npostgresql官方下载: https://www.postgresql.org/download/\n\n#### 1. for ubuntu\n\nhttps://www.postgresql.org/download/linux/ubuntu/\n\n创建postgresql仓库文件`/etc/apt/sources.list.d/pgdg.list`, 以添加以下内容:\n\n`for 18.04`:\n\n```\ndeb http://apt.postgresql.org/pub/repos/apt/ bionic-pgdg main\n```\n\n`for 16.04`:\n\n```\ndeb http://apt.postgresql.org/pub/repos/apt/ xenial-pgdg main\n```\n\n`for 14.04`:\n\n```\ndeb http://apt.postgresql.org/pub/repos/apt/ trusty-pgdg main\n```\n\n保存退出．\n\n导入仓库签名文件并更新仓库文件列表:\n\n```\nwget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -\nsudo apt-get update\n```\n\n安装postgresql:\n\n```\nsudo apt-get install postgresql-10\n```\n\n安装完成后会打印如下信息:\n\n```\nVer Cluster Port Status Owner    Data directory              Log file\n10  main    5432 down   postgres /var/lib/postgresql/10/main /var/log/postgresql/postgresql-10-main.log\n```\n\n可知:\n\n- 数据文件目录: /var/lib/postgresql/10/main\n- 日志文件: /var/log/postgresql/postgresql-10-main.log\n- 拥有者是postgres用户\n\n安装完成后，默认会：\n\n- 创建名为`postgres`的Linux用户\n\n- 创建名为`postgres`, 不带密码的默认数据库账号作为数据库管理员\n\n- 创建名为`postgres`的表\n\nPostgreSQL客户端为`psql`.\n\n查看版本号：\n\n```\n$ psql --version\npsql (PostgreSQL) 10.7 (Ubuntu 10.7-1.pgdg16.04+1)\n```\n\n创建名为`op`用户，　并可指明是否为超级管理员:\n\n```\n$ sudo -u postgres createuser --interactive\nEnter name of role to add: op\nShall the new role be a superuser? (y/n) y\n$ \n```\n\n与下等同:\n\n```\nsudo -u postgres createuser --superuser op\n```\n\n修改用户`op`的密码:\n\n```\n$ sudo -u postgres psql\npsql (10.7 (Ubuntu 10.7-1.pgdg16.04+1))\nType \"help\" for help.\n\npostgres=# \\password op;\nEnter new password: \nEnter it again: \npostgres=# \\q\n```\n\n创建用户\"op\"并设置密码`123456`:\n\n```\n$ sudo -u postgres psql\npostgres=# create user op with password '123456';\n```\n\n创建数据库，　名为`opplatform`:\n\n```\nsudo -u postgres createdb opplatform\n```\n\n创建数据库并指定所有者，　其中数据库名为`opplatform`，　数据库所有者为`op`:\n\n```\nsudo -u postgres createdb -O op opplatform;\n```\n\n创建数据库`opplatform`，所有者为`op`:\n\n```\n$ sudo -u postgres psql\npostgres=# create database opplatform owner op;\n```\n\n连接postgresql的shell:\n\n```\n$ sudo -u postgres psql\npsql (10.7 (Ubuntu 10.7-1.pgdg16.04+1))\nType \"help\" for help.\n\npostgres=#\n```\n\n查看所有数据库及其拥有者:\n\n```\n$ sudo -u postgres psql\npsql (10.7 (Ubuntu 10.7-1.pgdg16.04+1))\nType \"help\" for help.\n\npostgres=# \\l\n\nList of databases\n    Name    |  Owner   | Encoding |   Collate   |    Ctype    |   Access privileges   \n------------+----------+----------+-------------+-------------+-----------------------\n opplatform | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | \n postgres   | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | \n template0  | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +\n            |          |          |             |             | postgres=CTc/postgres\n template1  | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +\n            |          |          |             |             | postgres=CTc/postgres\n(4 rows)\n```\n\n修改数据库`opplatform`的拥有者为`op`:\n\n```\npostgres=# alter database opplatform owner to op;\nALTER DATABASE\npostgres=# \n```\n\n退出postgresql的shell:\n\n```\npostgres=# \\q\n```\n\n奖数据库`opplatform`的所有权授予给用户`op`:\n\n```\npostgres=# grant all privileges on database opplatform to op;\nGRANT\npostgres=# \n```\n\n用户`op`连接数据库`opplatform`, 报错:\n\n```\n$ psql -d opplatform -U op -W\nPassword for user op: \npsql: FATAL:  Peer authentication failed for user \"op\"\n```\n\n解决方法:\n\n```\n$ sudo vim /etc/postgresql/10/main/pg_hba.conf\n```\n\n将以下内容:\n\n```\n# \"local\" is for Unix domain socket connections only\nlocal   all             all                                     peer\n```\n\n修改为:\n\n```\n# \"local\" is for Unix domain socket connections only\nlocal   all             all                                     trust\n```\n\n详见: https://www.postgresql.org/docs/11/auth-pg-hba-conf.html\n\n```\n$ sudo /etc/init.d/postgresql reload\n[ ok ] Reloading postgresql configuration (via systemctl): postgresql.service.\n$ sudo systemctl enable postgresql\n$ sudo systemctl start postgresql\n$ sudo systemctl stop postgresql\n$ sudo systemctl restart postgresql\n```\n\n重新执行， 如下， 成功连接:\n\n```\n$ psql -d opplatform -U op -W\nPassword for user op: \npsql (10.7 (Ubuntu 10.7-1.pgdg16.04+1))\nType \"help\" for help.\n\nopplatform=# \n```\n\npostgresql远程授权:\n\n```\nsudo vim /etc/postgresql/10/main/pg_hba.conf\n```\n\n追加以下内容:\n\n```\n# IPv4 local connections:\nhost    all             all             127.0.0.1/32            md5\nhost    all             all             0.0.0.0/0            password\n```\n\n其中，`address`为`0.0.0.0/0`, `auth-method`为`password`\n\n还要修改配置文件:\n\n```\nsudo vim /etc/postgresql/10/main/postgresql.conf\n```\n\n将`listen_addresses = 'localhost'`修改为`listen_addresses = '*'`\n\n重启postgresql服务生效:\n\n```\nsudo systemctl restart postgresql\n```\n\n测试是否能远程连接:\n如： 通过navicat premium创建`postgresql`连接， 填写主机，商品， 初始数据库， 用户名， 密码， 点击\"测试连接\"， 即可显示\"连接成功\"。\n\n\n#### 2. for centos\n\n未完， 待续...\n","tags":["linux","数据库","postgresql"],"categories":["postgresql"]},{"title":"程序猿(媛)养成记","url":"/2019/01/11/how-to-be-a-nb-coder/","content":"\n#### 行为习惯Behavior\n\n#### 程序语言Programming Language\n\n#### 开发工具dev tools\n\n#### 技术栈Technology Stack\n\n#### 架构Architecture\n\n#### 编码规范code style\n\n#### 运维部署DevOps\n\n#### 安全Security\n\n#### 密码学Cryptology\n\n#### 统计学Statistics\n\n#### 前端Frontend\n\n#### 后端backend\n\n#### 美工UI\n\n#### 数据库database\n\n#### 移动互联网Mobile Internet\n\n#### 大数据与云BigData and Cloud\n\n#### 开源opensource\n\n#### 英文english\n\n#### 打杂other\n\n","tags":["程序员","码农","养成记","技术栈","学习"],"categories":["杂谈"]},{"title":"linux下安装elasticsearch","url":"/2018/12/24/install-elasticsearch-on-linux/","content":"\n#### 1. 安装JDK\n\njdk8下载地址：\n\n<http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html>\n\n安装依赖工具：\n\n`for ubuntu`:\n\n```\nsudo apt-get install vim wget lsof curl git\n```\n\n`for centos`:\n\n```\nsudo yum install vim wget lsof curl git\n```\n\nwget命令下载：\n\n```\nwget -c --no-check-certificate https://download.oracle.com/otn-pub/java/jdk/8u191-b12/2787e4a523244c269598db4e85c51e0c/jdk-8u191-linux-x64.tar.gz?AuthParam=1545381787_076fe948da7f81e0fdd1b0b99cf164f0 -O jdk-8u191-linux-x64.tar.gz\n```\n\n其中， jdk安装包的下载链接可以点击相应的`tar.gz`包， 然后浏览器弹出下载框下载， 在下载页面右键拷贝获取， 一定时候内会失效， 失效则重新获取， `-O`表示重命名\n\n解压并安装：\n\n```\ntar -xzvf jdk-8u191-linux-x64.tar.gz\nsudo mkdir -p /usr/local/java/\nsudo mv jdk1.8.0_191 /usr/local/java/\n```\n\n配置环境变量：\n\n```\nsudo vim /etc/profile\n# for zsh\nsudo vim /etc/zsh/zprofile\n```\n\n在文件最后追加：\n\n```\nexport JAVA_HOME=/usr/local/java/jdk1.8.0_191\nexport CLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar\nexport PATH=$PATH:$JAVA_HOME/bin\n```\n\n注意， `JAVA_HOME`修改为你自己的路径\n\n检测java是否安装成功：\n\n```\n$ java -version\njava version \"1.8.0_191\"\nJava(TM) SE Runtime Environment (build 1.8.0_191-b12)\nJava HotSpot(TM) 64-Bit Server VM (build 25.191-b12, mixed mode)\n```\n\n注意， 如果是ubuntu系统， 在安装elasticsearch时若报如下错误：\n\n```\ncould not find java; set JAVA_HOME or ensure java is in PATH\n```\n\n则需要设置默认的JDK才可解决：\n\n```\nsudo update-alternatives --install \"/usr/bin/java\" \"java\" \"/usr/local/java/jdk1.8.0_191/bin/java\" 300\n```\n\n\n#### 2. 安装elasticsearch\n\n##### 2.1. for ubuntu\n\n官方安装方法(deb包拉取)： https://www.elastic.co/guide/en/elasticsearch/reference/current/deb.html\n\n以ubuntu16.04.5为例。\n\n导入elasticsearch密钥：\n\n```\nwget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -\n```\n\n通过APT仓库安装：\n\n```\nsudo apt-get install apt-transport-https\necho \"deb https://artifacts.elastic.co/packages/6.x/apt stable main\" | sudo tee -a /etc/apt/sources.list.d/elastic-6.x.list\n```\n\n安装elasticsearch：\n\n```\nsudo apt-get update\nsudo apt-get install elasticsearch\n```\n\n\n##### 2.2. for centos\n\n官方安装方法(rpm包拉取)： https://www.elastic.co/guide/en/elasticsearch/reference/current/rpm.html\n\n安装公钥：\n\n```\nrpm --import https://artifacts.elastic.co/GPG-KEY-elasticsearch\n```\n\n在目录`/etc/yum.repos.d/`下创建创建elasticsearch仓库文件`elasticsearch.repo`：\n\n```\nsudo vim /etc/yum.repos.d/elasticsearch.repo\n```\n\n内容如下：\n\n```\n[elasticsearch-6.x]\nname=Elasticsearch repository for 6.x packages\nbaseurl=https://artifacts.elastic.co/packages/6.x/yum\ngpgcheck=1\ngpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch\nenabled=1\nautorefresh=1\ntype=rpm-md\n```\n\n从rpm仓库中安装elasticsearch:\n\n```\nsudo yum update\nsudo yum install elasticsearch \n```\n\n\n#### 3. systemctl管理elasticsearch服务\n\n配置elasticsearch服务开机自启动：\n\n```\nsudo systemctl daemon-reload\nsudo systemctl enable elasticsearch.service\n```\n\nelasticsearch服务的开启/关闭/重启：\n\n```\nsudo systemctl start elasticsearch.service\nsudo systemctl stop elasticsearch.service\nsudo systemctl restart elasticsearch.service\n```\n\n`lsof`命令通过端口检测进程：\n\n```\n$ sudo lsof -i:9200                           \nCOMMAND   PID          USER   FD   TYPE DEVICE SIZE/OFF NODE NAME\njava    28767 elasticsearch  250u  IPv6 214565      0t0  TCP localhost:9200 (LISTEN)\njava    28767 elasticsearch  251u  IPv6 214564      0t0  TCP ip6-localhost:9200 (LISTEN)\n\n```\n\n测试:\n\n```\n# for curl\ncurl http://127.0.0.1:9200\n# or\ncurl -XGET localhost:9200\n# for httpie\nhttp get http://127.0.0.1:9200\n```\n\n结果：\n\n```\n{\n    \"cluster_name\": \"elasticsearch\",\n    \"cluster_uuid\": \"AQQKRvPORQGdwcrLKZQcMw\",\n    \"name\": \"lev6ACu\",\n    \"tagline\": \"You Know, for Search\",\n    \"version\": {\n        \"build_date\": \"2018-12-17T21:17:40.758843Z\",\n        \"build_flavor\": \"default\",\n        \"build_hash\": \"d2ef93d\",\n        \"build_snapshot\": false,\n        \"build_type\": \"deb\",\n        \"lucene_version\": \"7.5.0\",\n        \"minimum_index_compatibility_version\": \"5.0.0\",\n        \"minimum_wire_compatibility_version\": \"5.6.0\",\n        \"number\": \"6.5.4\"\n    }\n}\n```\n\n#### 4. 附elasticsearch.service文件内容\n\n`for ubuntu`, 以ubuntu16.04.5为例\n`elasticsearch.service`:\n\n```\n[Unit]\nDescription=Elasticsearch\nDocumentation=http://www.elastic.co\nWants=network-online.target\nAfter=network-online.target\n\n[Service]\nRuntimeDirectory=elasticsearch\nPrivateTmp=true\nEnvironment=ES_HOME=/usr/share/elasticsearch\nEnvironment=ES_PATH_CONF=/etc/elasticsearch\nEnvironment=PID_DIR=/var/run/elasticsearch\nEnvironmentFile=-/etc/default/elasticsearch\n\nWorkingDirectory=/usr/share/elasticsearch\n\nUser=elasticsearch\nGroup=elasticsearch\n\nExecStart=/usr/share/elasticsearch/bin/elasticsearch -p ${PID_DIR}/elasticsearch.pid --quiet\n\n# StandardOutput is configured to redirect to journalctl since\n# some error messages may be logged in standard output before\n# elasticsearch logging system is initialized. Elasticsearch\n# stores its logs in /var/log/elasticsearch and does not use\n# journalctl by default. If you also want to enable journalctl\n# logging, you can simply remove the \"quiet\" option from ExecStart.\nStandardOutput=journal\nStandardError=inherit\n\n# Specifies the maximum file descriptor number that can be opened by this process\nLimitNOFILE=65536\n\n# Specifies the maximum number of processes\nLimitNPROC=4096\n\n# Specifies the maximum size of virtual memory\nLimitAS=infinity\n\n# Specifies the maximum file size\nLimitFSIZE=infinity\n\n# Disable timeout logic and wait until process is stopped\nTimeoutStopSec=0\n\n# SIGTERM signal is used to stop the Java process\nKillSignal=SIGTERM\n\n# Send the signal only to the JVM rather than its control group\nKillMode=process\n\n# Java process is never killed\nSendSIGKILL=no\n\n# When a JVM receives a SIGTERM signal it exits with code 143\nSuccessExitStatus=143\n\n[Install]\nWantedBy=multi-user.target\n\n# Built for packages-6.5.4 (packages)\n\n```\n","tags":["linux","elasticsearch","搜索","elk","jdk"],"categories":["linux"]},{"title":"如何在github提交PR(Pull Request)","url":"/2018/12/13/how-to-submit-PR-in-github/","content":"\n拿本人在github上开源的[cookiecutter-django](https://github.com/xiongxianzhu/cookiecutter-django)为例。\n\n#### 1. fork repository\n\nFork 开源项目, 单击[cookiecutter-django](https://github.com/xiongxianzhu/cookiecutter-django)页面顶部附近的`Fork`按钮, 这将在GitHub服务器上创建您帐户下的代码副本。\n\n#### 2. 克隆代码副本到本地磁盘\n\n```\n$ git clone git@github.com:xiongxianzhu/cookiecutter-django.git\n$ cd cookiecutter-django\n```\n\n#### 3. 创建新分支\n\n创建一个新分支来保存您的更改并开始进行更改， 不要在主分支(master分支)上工作。\n\n```\n$ git checkout -b my-feature\n```\n\n等同于：\n\n```\n$ git branch my-feature\n$ git checkout my-feature\n```\n\n#### 4. commit提交你的更改到新分支\n\n上面已经切换到新分支`my-feature`, 在新分支`my-feature`下进行更改， 然后通过`git add`和`git commit`命令来提交更改到新分支。\n\n```\n$ git add modified_files\n$ git commit -m 'changelog'\n```\n\n#### 5. push推送您的更改到github上\n\n通过`git push`命令推送到源码库repository所在的git托管网站， 本处的git托管网站为`github`, 若第一次推送， 则需要添加`-u`参数。\n\n```\n$ git push -u origin my-feature\n```\n\n#### 6. 新建PR发送您的更改以供审核\n\n最后，转到`cookiecutter-django` repo的[Pull requests](https://github.com/xiongxianzhu/cookiecutter-django/pulls)页面，然后单击`New Pull Request`发送您的更改以供审核\n\n#### 7. GitHub Pull Request文档\n\n如果您不熟悉`Pull Request`，请查看[pull request docs](https://help.github.com/articles/about-pull-requests/)\n","tags":["git","PR","github"],"categories":["git"]},{"title":"ubuntu16.04安装mysql5.7.24","url":"/2018/12/11/install-mysql5-7-24-on-ubuntu16-04/","content":"\n\n参考本人CSDN博客上写的文章： [64位centos6.7安装mysql-5.7.9-linux-glibc2.5-x86_64.tar.gz](https://blog.csdn.net/Cryhelyxx/article/details/49757217)\n\n#### 1. 下载安装包及安装相关依赖\n\n官网： http://dev.mysql.com/downloads/mysql/\n\nmysql搜狐镜像站：\nhttp://mirrors.sohu.com/mysql/\n\n```\nmkdir ~/soft/\ncd ~/soft/\nwget -c http://mirrors.sohu.com/mysql/MySQL-5.7/mysql-5.7.24-linux-glibc2.12-x86_64.tar.gz\n```\n\n安装mysql前先安装所需依赖：\n\n```\nsudo apt-get install libmysqlclient-dev python3-dev\n```\n\n#### 2. 创建mysql的用户组/用户, data目录及其用户目录\n\n```\nsudo groupdel mysql\nsudo userdel mysql\nsudo groupadd mysql\nsudo useradd -g mysql -d /home/mysql -m mysql\nsudo mkdir -p /home/mysql/data\n```\n\n#### 3. 解压安装包并将解压包里的内容拷贝到mysql的安装目录/home/mysql\n\n```\ntar -xzvf mysql-5.7.24-linux-glibc2.12-x86_64.tar.gz\ncd ~/soft/mysql-5.7.24-linux-glibc2.12-x86_64/\nsudo mv * /home/mysql\n```\n\n#### 4. 初始化mysql数据库\n\n```\ncd /home/mysql\n./bin/mysqld --user=mysql --basedir=/home/mysql --datadir=/home/mysql/data --initialize\n```\n\n在上面命令执行完后， 牢记最后一行打印信息的随机密码， 如上`**mjT,#x_5sW`, 下面我们修改密码时需要用到。\n\n#### 5. 编辑mysql服务文件\n\n```\nvim /home/mysql/support-files/mysql.server\n#########修改basedir和datadir==========\nbasedir=/home/mysql\ndatadir=/home/mysql/data\n############end############\n```\n\n#### 6. 创建软链接\n\n```\nsudo ln -s /home/mysql/bin/mysql /usr/bin/mysql\n```\n\n#### 7. 创建配置文件\n\n若存在`/etc/my.cnf`, 将默认生成的my.cnf备份:\n\n```\nsudo mv /etc/my.cnf /etc/my.cnf.bak\n```\n\n创建配置文件:\n\n```\nsudo vim /etc/my.cnf\n```\n\n`/etc/my.cnf`配置文件内容如下：\n\n```\n[mysqld]\n\nbasedir = /home/mysql\ndatadir = /home/mysql/data\n\ncharacter_set_server=utf8\ninit_connect='SET NAMES utf8'\nsocket=/home/mysql/mysql.sock\n\n[client]\ndefault-character-set=utf8\nsocket=/home/mysql/mysql.sock\n```\n\n#### 8. 配置mysql服务开机自动启动\n\n```\nsudo cp /home/mysql/support-files/mysql.server /etc/init.d/mysqld\nsudo chmod 755 /etc/init.d/mysqld\nsystemctl enable mysqld\nsystemctl start mysqld\nsudo lsof -i:3306\n```\n\n#### 9. 修改初始化时mysql用户root的密码\n\n通过`mysqladmin`命令来修改root密码, 原密码为`mysqld --initialize`时牢记下的随机密码， 并检测mysql编码集是否为utf-8， 如下:\n\n```\ncd /home/mysql\n$ ./bin/mysqladmin -u root -p password\nEnter password: \nNew password: \nConfirm new password: \nWarning: Since password will be sent to server in plain text, use ssl connection to ensure password safety.\n$ mysql -uroot -p\nEnter password: \nWelcome to the MySQL monitor. Commands end with ; or \\g.\nYour MySQL connection id is 3\nServer version: 5.7.24 MySQL Community Server (GPL)\n\nCopyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql> \\s\n--------------\nmysql Ver 14.14 Distrib 5.7.24, for linux-glibc2.12 (x86_64) using EditLine wrapper\n\nConnection id: 3\nCurrent database: \nCurrent user: root@localhost\nSSL: Not in use\nCurrent pager: less\nUsing outfile: ''\nUsing delimiter: ;\nServer version: 5.7.24 MySQL Community Server (GPL)\nProtocol version: 10\nConnection: Localhost via UNIX socket\nServer characterset: utf8\nDb characterset: utf8\nClient characterset: utf8\nConn. characterset: utf8\nUNIX socket: /tmp/mysql.sock\nUptime: 3 min 18 sec\n\nThreads: 1 Questions: 9 Slow queries: 0 Opens: 106 Flush tables: 1 Open tables: 99 Queries per second avg: 0.045\n--------------\n\nmysql> show variables like \"%char%\";\n+--------------------------+-----------------------------+\n| Variable_name | Value |\n+--------------------------+-----------------------------+\n| character_set_client | utf8 |\n| character_set_connection | utf8 |\n| character_set_database | utf8 |\n| character_set_filesystem | binary |\n| character_set_results | utf8 |\n| character_set_server | utf8 |\n| character_set_system | utf8 |\n| character_sets_dir | /home/mysql/share/charsets/ |\n+--------------------------+-----------------------------+\n8 rows in set (0.00 sec)\n\nmysql> \n```\n\n#### 10. mysql相关命令\n\np.s. 非root用户在执行以下命令前要加`sudo `\n\n启动mysql服务： `systemctl start mysqld`\n\n停止mysql服务： `systemctl stop mysqld`\n\n重启mysql服务： `systemctl restart mysqld`\n\n查看mysql服务状态： `systemctl status mysqld` or `lsof -i:3306`\n\n","tags":["linux","ubuntu","mysql"],"categories":["ubuntu"]},{"title":"linux安装nodejs,npm,cnpm,bower,hexo","url":"/2018/12/05/install-nodejs-npm-cnpm-bower-hexo-on-linux/","content":"\nnodejs长期LTS稳定版： https://nodejs.org/en/download/\n\nnodejs最新版： https://nodejs.org/en/download/current/\n\nlinux选择： `Linux Binaries (x64)`\n\n```\n$ wget -c https://nodejs.org/dist/v10.14.1/node-v10.14.1-linux-x64.tar.xz\n$ xz -d node-v10.14.1-linux-x64.tar.xz\n$ tar -xvf node-v10.14.1-linux-x64.tar\n$ sudo mv node-v10.14.1-linux-x64 /usr/local/node\n$ sudo ln -s /usr/local/node/bin/npm /usr/bin/npm\n$ sudo ln -s /usr/local/node/bin/node /usr/bin/node\n$ npm -v\n6.4.1\n$ node -v\nv10.14.1\n$ npm install -g cnpm --registry=https://registry.npm.taobao.org\n$ sudo ln -s /usr/local/node/bin/cnpm /usr/bin/cnpm\n$ cnpm -v\n$ cnpm install -g bower\n$ sudo ln -s /usr/local/node/bin/bower /usr/bin/bower\n$ bower -v\n1.8.4\n$ cnpm i hexo -g\n$ sudo ln -s /usr/local/node/bin/hexo /usr/bin/hexo\n$ hexo -v\n```","tags":["nodejs","npm","bower"],"categories":["linux"]},{"title":"linux源码编译安装nginx1.15.7","url":"/2018/12/05/install-nginx1-15-7-from-source-on-linux/","content":"\n\n#### 1. 源码包准备\n\n安装nginx所需工具源码包下载地址：\n\n`nginx`: https://nginx.org/download/\n`pcre`:  http://www.pcre.org/\n`zlib`:  https://www.zlib.net/\n`openssl`: https://www.openssl.org/\n\n安装nginx所需源码包：\n\n- nginx-1.15.7.tar.gz\n- pcre-8.42.tar.gz\n- zlib-1.2.11.tar.gz\n- openssl-1.1.1a.tar.gz\n\n通过`wget`命令下载：\n\n```bash\nwget -c https://nginx.org/download/nginx-1.15.7.tar.gz\nwget -c https://ftp.pcre.org/pub/pcre/pcre-8.42.tar.gz\nwget -c https://www.zlib.net/zlib-1.2.11.tar.gz\nwget -c https://www.openssl.org/source/openssl-1.1.1a.tar.gz\n```\n\n解压：\n\n```bash\ntar -xzvf nginx-1.15.7.tar.gz\ntar -xzvf pcre-8.42.tar.gz\ntar -xzvf zlib-1.2.11.tar.gz\ntar -xzvf openssl-1.1.1a.tar.gz\n```\n\n#### 2. 编译环境工具安装\n\n`for centos`:\n\n```\nsudo yum check-update || sudo yum update -y\nsudo yum groupinstall -y 'Development Tools' && sudo yum install -y vim\nsudo yum install -y epel-release\nsudo yum install -y perl perl-devel perl-ExtUtils-Embed libxslt libxslt-devel libxml2 libxml2-devel gd gd-devel GeoIP GeoIP-devel\n```\n\n`for ubuntu`:\n\n可选依赖进行安装:\n\n- [PERL](https://www.perl.org/)\n- LIBATOMIC_OPS\n- [LibGD](https://libgd.github.io/)\n- MaxMind GeoIP\n- [libxml2](http://xmlsoft.org/)\n- [libxslt](http://xmlsoft.org/libxslt/)\n\n\n```\nsudo apt update && sudo apt upgrade -y\nsudo apt install build-essential -y\nsudo apt install libxml2 libxml2-dev libxslt1.1 libxslt1-dev libgd-dev\n```\n\n#### 3. 源码编译安装nginx\n\n`for centos`:\n\n```\n./configure --prefix=/usr/local/nginx \\\n            --sbin-path=/usr/sbin/nginx \\\n            --conf-path=/etc/nginx/nginx.conf \\\n            --user=nginx \\\n            --group=nginx \\\n            --pid-path=/var/run/nginx.pid \\\n            --lock-path=/var/run/nginx.lock \\\n            --error-log-path=/var/log/nginx/error.log \\\n            --http-log-path=/var/log/nginx/access.log \\\n            --with-select_module \\\n            --with-poll_module \\\n            --with-threads \\\n            --with-file-aio \\\n            --with-http_ssl_module \\\n            --with-http_v2_module \\\n            --with-http_realip_module \\\n            --with-http_addition_module \\\n            --with-http_xslt_module=dynamic \\\n            --with-http_image_filter_module=dynamic \\\n            --with-http_geoip_module=dynamic \\\n            --with-http_sub_module \\\n            --with-http_dav_module \\\n            --with-http_flv_module \\\n            --with-http_mp4_module \\\n            --with-http_gunzip_module \\\n            --with-http_gzip_static_module \\\n            --with-http_auth_request_module \\\n            --with-http_random_index_module \\\n            --with-http_secure_link_module \\\n            --with-http_degradation_module \\\n            --with-http_slice_module \\\n            --with-http_stub_status_module \\\n            --with-mail=dynamic \\\n            --with-mail_ssl_module \\\n            --with-stream \\\n            --with-stream_ssl_module \\\n            --with-stream_realip_module \\\n            --with-stream_geoip_module=dynamic \\\n            --with-stream_ssl_preread_module \\\n            --with-compat \\\n            --with-pcre=../pcre-8.42 \\\n            --with-pcre-jit \\\n            --with-zlib=../zlib-1.2.11 \\\n            --with-openssl=../openssl-1.1.1a \\\n            --with-openssl-opt=no-nextprotoneg \\\n            --with-debug\n\nmake\nsudo make install\n```\n\n`for ubuntu`:\n\n```\n./configure --prefix=/usr/local/nginx \\\n            --sbin-path=/usr/sbin/nginx \\\n            --conf-path=/etc/nginx/nginx.conf \\\n            --user=nginx \\\n            --group=nginx \\\n            --pid-path=/var/run/nginx.pid \\\n            --lock-path=/var/run/nginx.lock \\\n            --error-log-path=/var/log/nginx/error.log \\\n            --http-log-path=/var/log/nginx/access.log \\\n            --with-select_module \\\n            --with-poll_module \\\n            --with-threads \\\n            --with-file-aio \\\n            --with-http_ssl_module \\\n            --with-http_v2_module \\\n            --with-http_realip_module \\\n            --with-http_addition_module \\\n            --with-http_sub_module \\\n            --with-http_dav_module \\\n            --with-http_flv_module \\\n            --with-http_mp4_module \\\n            --with-http_gunzip_module \\\n            --with-http_gzip_static_module \\\n            --with-http_auth_request_module \\\n            --with-http_random_index_module \\\n            --with-http_secure_link_module \\\n            --with-http_degradation_module \\\n            --with-http_slice_module \\\n            --with-http_stub_status_module \\\n            --with-mail=dynamic \\\n            --with-mail_ssl_module \\\n            --with-stream \\\n            --with-stream_ssl_module \\\n            --with-stream_realip_module \\\n            --with-stream_ssl_preread_module \\\n            --with-compat \\\n            --with-pcre=../pcre-8.42 \\\n            --with-pcre-jit \\\n            --with-zlib=../zlib-1.2.11 \\\n            --with-openssl=../openssl-1.1.1a \\\n            --with-openssl-opt=no-nextprotoneg \\\n            --with-debug\n\nmake\nsudo make install\n```\n\n#### 4. 打印nginx版本，编译器版本及配置脚本选项\n\n```\nsudo nginx -V\n\nnginx version: nginx/1.15.7\nbuilt by gcc 4.8.5 20150623 (Red Hat 4.8.5-36) (GCC) \nbuilt with OpenSSL 1.1.1a  20 Nov 2018\nTLS SNI support enabled\nconfigure arguments: --prefix=/usr/local/nginx --conf-path=/etc/nginx/nginx.conf --user=nginx --group=nginx --pid-path=/var/run/nginx/nginx.pid --lock-path=/var/run/nginx.lock --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --with-select_module --with-poll_module --with-threads --with-file-aio --with-http_ssl_module --with-http_v2_module --with-http_realip_module --with-http_addition_module --with-http_xslt_module=dynamic --with-http_image_filter_module=dynamic --with-http_geoip_module=dynamic --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_auth_request_module --with-http_random_index_module --with-http_secure_link_module --with-http_degradation_module --with-http_slice_module --with-http_stub_status_module --with-mail=dynamic --with-mail_ssl_module --with-stream --with-stream_ssl_module --with-stream_realip_module --with-stream_geoip_module=dynamic --with-stream_ssl_preread_module --with-compat --with-pcre=../pcre-8.42 --with-pcre-jit --with-zlib=../zlib-1.2.11 --with-openssl=../openssl-1.1.1a --with-openssl-opt=no-nextprotoneg --with-debug\n```\n\n#### 5. 创建nginx用户及用户组\n\n```\nsudo useradd --system --home /var/cache/nginx --shell /sbin/nologin --comment \"nginx user\" --user-group nginx\n```\n\n#### 6. 创建nginx systemd unit文件\n\n`for centos`:\n\n```\nsudo vim /usr/lib/systemd/system/nginx.service\n```\n\n或\n\n```\nsudo vim /lib/systemd/system/nginx.service\n```\n\n拷贝粘贴以下内容:\n\n```\n[Unit]\nDescription=nginx - high performance web server\nDocumentation=https://nginx.org/en/docs/\nAfter=network-online.target remote-fs.target nss-lookup.target\nWants=network-online.target\n\n[Service]\nType=forking\nPIDFile=/var/run/nginx.pid\nExecStartPre=/usr/sbin/nginx -t -c /etc/nginx/nginx.conf\nExecStart=/usr/sbin/nginx -c /etc/nginx/nginx.conf\nExecReload=/bin/kill -s HUP $MAINPID\nExecStop=/bin/kill -s TERM $MAINPID\n\n[Install]\nWantedBy=multi-user.target\n```\n\n`for ubuntu`:\n\n```\nsudo vim /etc/systemd/system/nginx.service\n```\n\n或\n\n```\nsudo vim /lib/systemd/system/nginx.service\n```\n\n拷贝粘贴以下内容:\n\n```\n[Unit]\nDescription=A high performance web server and a reverse proxy server\nAfter=network.target\n\n[Service]\nType=forking\nPIDFile=/var/run/nginx.pid\nExecStartPre=/usr/sbin/nginx -t -q -g 'daemon on; master_process on;'\nExecStart=/usr/sbin/nginx -g 'daemon on; master_process on;'\nExecReload=/usr/sbin/nginx -g 'daemon on; master_process on;' -s reload\nExecStop=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /var/run/nginx.pid\nTimeoutStopSec=5\nKillMode=mixed\n\n[Install]\nWantedBy=multi-user.target\n```\n\n#### 7. 开启并启用nginx服务开机自启动\n\n```\nsudo systemctl start nginx.service && sudo systemctl enable nginx.service\nsudo systemctl daemon-reload\n```\n\n检查nginx服务是否会在重启后自启动:\n\n```\nsudo systemctl is-enabled nginx.service\n# enabled\n```\n\n重启你的vps查看nginx服务是否自启动:\n\n```\nsudo shutdown -r now\n```\n\n检查nginx是否正在运行:\n\n```\nsudo systemctl status nginx.service\nps aux | grep nginx\ncurl -I 127.0.0.1\nsudo lsof -i:80\n```\n\n#### 8. nginx服务管理\n\nnginx服务启动:\n\n```\nsudo systemctl start nginx\n```\n\nnginx服务停止:\n\n```\nsudo systemctl stop nginx\n```\n\nnginx服务重启:\n\n```\nsudo systemctl restart nginx\n```\n\nnginx配置文件热更新:\n\n```\nsudo nginx -s reload\n```\n\nnginx配置文件语法检查:\n\n```\nsudo nginx -t\n```\n\n#### 9. 端口监听检查\n\n```\nsudo netstat -anp\nsudo netstat -tualpn | grep LISTEN\nsudo netstat -tualpn | grep 80\nsudo netstat -tualpn | grep 443\n\ntelnet [IP/域名] 443\nTrying [IP]...\nConnected to [IP/域名].\nEscape character is '^]'.\nConnection closed by foreign host.\n```\n\n#### 创建nginx配置文件目录\n\n在nginx配置文件根目录下创建目录`conf.d`:\n\n```\nsudo mkdir -p /etc/nginx/conf.d\n```\n\n在nginx配置文件`/etc/nginx/nginx.conf`使`/etc/nginx/conf.d`生效，在http模块内添加`include /etc/nginx/conf.d/*.conf;`, `nginx.conf`文件内容示例如下:\n\n```\n\n# user  nobody;\nuser nginx nginx;\nworker_processes  4;\n\n#error_log  logs/error.log;\n#error_log  logs/error.log  notice;\n#error_log  logs/error.log  info;\nerror_log /var/log/nginx/error.log info;\n\n#pid        logs/nginx.pid;\n\n\nevents {\n    worker_connections  1024;\n}\n\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n                      '$status $body_bytes_sent \"$http_referer\" '\n                      '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n\n    access_log  /var/log/nginx/access.log  main;\n\n    sendfile        on;\n    #tcp_nopush     on;\n\n    #keepalive_timeout  0;\n    keepalive_timeout  65;\n\n    #gzip  on;\n    include /etc/nginx/conf.d/*.conf;\n\n    server {\n        listen       80;\n        server_name  localhost;\n\n        #charset koi8-r;\n\n        #access_log  logs/host.access.log  main;\n\n        location / {\n            root   html;\n            index  index.html index.htm;\n        }\n\n        #error_page  404              /404.html;\n\n        # redirect server error pages to the static page /50x.html\n        #\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n\n        # proxy the PHP scripts to Apache listening on 127.0.0.1:80\n        #\n        #location ~ \\.php$ {\n        #    proxy_pass   http://127.0.0.1;\n        #}\n\n        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000\n        #\n        #location ~ \\.php$ {\n        #    root           html;\n        #    fastcgi_pass   127.0.0.1:9000;\n        #    fastcgi_index  index.php;\n        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;\n        #    include        fastcgi_params;\n        #}\n\n        # deny access to .htaccess files, if Apache's document root\n        # concurs with nginx's one\n        #\n        #location ~ /\\.ht {\n        #    deny  all;\n        #}\n    }\n\n\n    # another virtual host using mix of IP-, name-, and port-based configuration\n    #\n    #server {\n    #    listen       8000;\n    #    listen       somename:8080;\n    #    server_name  somename  alias  another.alias;\n\n    #    location / {\n    #        root   html;\n    #        index  index.html index.htm;\n    #    }\n    #}\n\n\n    # HTTPS server\n    #\n    #server {\n    #    listen       443 ssl;\n    #    server_name  localhost;\n\n    #    ssl_certificate      cert.pem;\n    #    ssl_certificate_key  cert.key;\n\n    #    ssl_session_cache    shared:SSL:1m;\n    #    ssl_session_timeout  5m;\n\n    #    ssl_ciphers  HIGH:!aNULL:!MD5;\n    #    ssl_prefer_server_ciphers  on;\n\n    #    location / {\n    #        root   html;\n    #        index  index.html index.htm;\n    #    }\n    #}\n\n}\n\n```\n\n***注意***： 在给nginx配置https证书时， 需要检查防火墙和阿里云安全组是否对443端口开放， 且安全组是否在nginx所在的ecs实例上。","tags":["linux","运维","nginx"],"categories":["nginx"]},{"title":"linux源码安装python3.6.7","url":"/2018/12/03/install-python3-6-7-from-source-on-linux/","content":"\n#### 源码安装python3.6.7\n\nhttps://www.python.org/\nhttps://www.python.org/downloads/\n\n选择`XZ compressed source tarball`， 拷贝文件绝对路径链接， 用wget命令下载\n\n```\n$ cd\n$ mkdir soft\n$ cd soft\n$ wget -c https://www.python.org/ftp/python/3.6.7/Python-3.6.7.tar.xz\n$ xz -d Python-3.6.7.tar.xz\n$ tar -xvf Python-3.6.7.tar\n$ cd Python-3.6.7\n$ sudo yum install -y readline-devel libffi-devel\n$ ./configure --prefix=/usr/local/python3.6 --with-ssl --enable-loadable-sqlite-extensions\n$ make && sudo make install\n```\n其中， 在configure加入--with-ssl是使用ssl功能模块。\n\n`for centos`:\n\n```\n$ sudo yum install -y readline-devel libffi-devel\n```\n\n`for ubuntu`:\n\n```\n$ sudo apt-get install -y build-essential openssl libssl-dev libreadline-dev libffi-dev libsqlite3-dev sqlite3\n```\n\n装好后，将 /usr/local/python3.6/bin 加入 PATH:\n\n```\nexport PATH=/usr/local/python3.6/bin:$PATH\n```\n在/etc/profile或/etc/zsh/zprofile或/etc/zprofile中添加以上环境变量， 并source /etc/profile  或 source /etc/zsh/zprofile 或source /etc/zprofile 使环境变量全局所有用户生效\n\n再在~/.zshrc后面追加source /etc/zsh/zprofile\n\n在~/.zshrc文件新追加的内容如下：\n\n```\nsource /etc/zsh/zprofile\n\nif [ -f /usr/local/python3.6/bin/virtualenvwrapper.sh ]; then\n    export WORKON_HOME=$HOME/.virtualenvs\n    source /usr/local/python3.6/bin/virtualenvwrapper.sh\nfi\n```\n\n检测python3.6.7是否安装成功：\n\n```\n$ python3\nPython 3.6.7 (default, Oct 30 2018, 17:39:33) \n[GCC 4.8.5 20150623 (Red Hat 4.8.5-28)] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import ssl\n>>> exit()\n```","tags":["linux","运维","python3"],"categories":["python"]},{"title":"linux下源码安装redis","url":"/2018/06/22/install-redis-on-linux/","content":"\nredis官方下载网址： https://redis.io/download\n\n安装目录： `/usr/local/bin/`\n配置文件路径： `/etc/redis/redis.conf`\n配置端口： `6379`\n服务端： `/usr/local/bin/redis-server`\n客户端： `/usr/local/bin/redis-cli`\n持久化文件存放目录路径： `/var/lib/redis`\npid路径： `/var/run/redis.pid`\n日志路径： `/var/log/redis.log`\n\n#### 1. centos下安装redis\n\n以centos7.4为例.\n\n##### 1.1. 源码编译安装\n\n```\n$ mkdir ~/soft\n$ cd ~/soft\n$ wget -c http://download.redis.io/releases/redis-4.0.10.tar.gz\n$ tar xzf redis-4.0.10.tar.gz\n$ cd redis-4.0.10\n$ make\n$ sudo make install\n```\n\n##### 1.2. 添加服务并添加到开机自启动\n\n```\n$ cd ~/soft/redis-4.0.10/utils\n$ sudo ./install_server.sh\n\nWelcome to the redis service installer\nThis script will help you easily set up a running redis server\n\nPlease select the redis port for this instance: [6379] \nSelecting default: 6379\nPlease select the redis config file name [/etc/redis/6379.conf] /etc/redis/redis.conf\nPlease select the redis log file name [/var/log/redis_6379.log] /var/log/redis.log\nPlease select the data directory for this instance [/var/lib/redis/6379] /var/lib/redis\nPlease select the redis executable path [] /usr/local/bin/redis-server\nSelected config:\nPort : 6379\nConfig file : /etc/redis/redis.conf\nLog file : /var/log/redis.log\nData dir : /var/lib/redis\nExecutable : /usr/local/bin/redis-server\nCli Executable : /usr/local/bin/redis-cli\nIs this ok? Then press ENTER to go on or Ctrl-C to abort.\nCopied /tmp/6379.conf => /etc/init.d/redis_6379\nInstalling service...\nSuccessfully added to chkconfig!\nSuccessfully added to runlevels 345!\nStarting Redis server...\nInstallation successful!\n\n$ \n```\n\n##### 1.3. 创建redis用户及其用户组并给相应目录授权\n\n```\n$ sudo useradd --r --U -M redis\n$ sudo chown redis:redis /var/lib/redis\n$ sudo chmod 770 /var/lib/redis\n```\n\n##### 1.4. 修改服务名及配置文件\n\n重命名服务名`redis_6379`为`redis`, 在此之前先停止服务:\n\n```\n$ sudo /etc/init.d/redis_6379 stop\n$ sudo mv /etc/init.d/redis_6379 /etc/init.d/redis\n$ sudo vim /etc/init.d/redis\n```\n\n将文件内的`redis_6379`替换为`redis`, vim按ESC切换到命令模式， 替换后保存退出vim\n\n```\n:%s/redis_6379/redis/g\n:wq\n```\n\n编辑配置文件`/etc/redis/redis.conf`：\n\n```\n$ sudo vim /etc/redis/redis.conf\n\n. . . \ndaemonize yes\n\n. . . \nsupervised systemd\n\n. . . \npidfile /var/run/redis.pid\n\n. . . \nlogfile /var/log/redis.log\n\n. . . \ndir /var/lib/redis\n\n```\n\n将文件内的`redis_6379`替换为`redis`, vim按ESC切换到命令模式， 替换后保存退出vim\n\n```\n:%s/redis_6379/redis/g\n:wq\n```\n\n##### 1.5. redis服务管理\n\n```\n$ sudo systemctl daemon-reload\n$ sudo systemctl enable redis\n$ sudo systemctl status redis\n● redis.service - LSB: start and stop redis\n   Loaded: loaded (/etc/rc.d/init.d/redis; bad; vendor preset: disabled)\n   Active: inactive (dead) since 五 2018-06-22 14:48:36 CST; 7s ago\n     Docs: man:systemd-sysv-generator(8)\n  Process: 21946 ExecStop=/etc/rc.d/init.d/redis stop (code=exited, status=0/SUCCESS)\n  Process: 21909 ExecStart=/etc/rc.d/init.d/redis start (code=exited, status=0/SUCCESS)\n\n6月 22 14:24:50 izm5eat3t2va6ch6mdbpbtz systemd[1]: Starting LSB: start and ...\n6月 22 14:24:50 izm5eat3t2va6ch6mdbpbtz redis[21909]: Starting Redis server...\n6月 22 14:24:50 izm5eat3t2va6ch6mdbpbtz systemd[1]: Started LSB: start and s...\n6月 22 14:48:36 izm5eat3t2va6ch6mdbpbtz systemd[1]: Stopping LSB: start and ...\n6月 22 14:48:36 izm5eat3t2va6ch6mdbpbtz redis[21946]: /var/run/redis.pid doe...\n6月 22 14:48:36 izm5eat3t2va6ch6mdbpbtz systemd[1]: Stopped LSB: start and s...\nHint: Some lines were ellipsized, use -l to show in full.\n\n$ sudo systemctl start redis\n● redis.service - LSB: start and stop redis\n   Loaded: loaded (/etc/rc.d/init.d/redis; bad; vendor preset: disabled)\n   Active: active (exited) since 五 2018-06-22 14:24:50 CST; 5s ago\n     Docs: man:systemd-sysv-generator(8)\n  Process: 21909 ExecStart=/etc/rc.d/init.d/redis start (code=exited, status=0/SUCCESS)\n\n6月 22 14:24:50 izm5eat3t2va6ch6mdbpbtz systemd[1]: Starting LSB: start and ...\n6月 22 14:24:50 izm5eat3t2va6ch6mdbpbtz redis[21909]: Starting Redis server...\n6月 22 14:24:50 izm5eat3t2va6ch6mdbpbtz systemd[1]: Started LSB: start and s...\nHint: Some lines were ellipsized, use -l to show in full.\n```\n\n开启服务： `sudo systemctl start redis`\n停止服务： `sudo systemctl stop redis`\n重启服务： `sudo systemctl restart redis`\n查看进程： `sudo lsof -i:6379`\n杀掉进程： `sudo kill -9 pid`\n进入redis shell: `redis-cli`\n\n#### 2. ubuntu下安装redis\n\n以ubuntu16.04为例.\n\n源码安装步骤与centos的基本相同。\n\n","tags":["linux","centos","redis","缓存","ubuntu"],"categories":["缓存"]},{"title":"ubuntu16.04.4下安装mongodb的图形管理工具robomongo","url":"/2018/05/30/install-robomongo-on-ubuntu16-04-4/","content":"\n#### 1. 官网下载\n\n从官网 https://robomongo.org/download 下载当前最新的`robomongo`程序包`robo3t-1.2.1-linux-x86_64-3e50a65.tar.gz`\n\n```\n$ mkdir -p ~/soft\n$ cd ~/soft/\n$ wget -c \"https://download.robomongo.org/1.2.1/linux/robo3t-1.2.1-linux-x86_64-3e50a65.tar.gz\"\n```\n\n#### 2. 解压并安装\n\n```\n$ cd ~/soft/\n$ tar -xzvf robo3t-1.2.1-linux-x86_64-3e50a65.tar.gz\n$ cd robo3t-1.2.1-linux-x86_64-3e50a65\n$ cd bin/\n$ ./robo3t\n$ cd ~/soft/\n$ sudo mv robo3t-1.2.1-linux-x86_64-3e50a65 /usr/local/robomongo\n```\n\n#### 3. 添加环境变量使命令生效\n\n添加环境变量`ROBOMONGO_HOME`， 并在环境变量`PATH`追加`$ROBOMONGO_HOME/bin`\n\n```\n$ sudo vim /etc/profile\n```\n\n追加的内容如下：\n\n```\nexport ROBOMONGO_HOME=/usr/local/robomongo\nexport PATH=$PATH:$ROBOMONGO_HOME/bin\n```\n\n使文件`/etc/profile`内新添加的环境变量生效：\n\n```\n$ source /etc/profile\n```\n\n对于使用了zsh shell代替base shell的用户， 执行完source命令后会回到base shell下， 若继续使用zsh shell， 则需要logout再login， 命令`robo3t`才生效\n\n```\n$ robo3t --version\nMongoDB shell version v3.4.3-8-g05b19c6\ngit version: 05b19c6063a4b02f9b0bccc034be68bb8cdac899\nOpenSSL version: OpenSSL 1.0.1u  22 Sep 2016\nallocator: tcmalloc\nmodules: none\nbuild environment:\n    distarch: x86_64\n    target_arch: x86_64\n```\n\nOK, Enjoy it~\n","tags":["mongodb","robomongo","图形管理工具"],"categories":["mongodb"]},{"title":"git常用命令","url":"/2018/05/25/git-commands/","content":"\n#### 1. 初始化git本地库\n\n```bash\ngit init\n```\n\n#### 2. 设置全局的git用户名和邮箱\n\n```bash\ngit config --global user.name 'yourname'\ngit config --global user.email 'youremail@example.com'\n```\n\n若只针对一个项目Repository, 则不需要参数`--global`\n\n#### 3. ssh-keygen命令生成ssh密钥\n\n```\ncd \"c:/Users/用户名/\"  # 对于windows系统用户， 进入到用户根目录下\ncd ~                # 对于linux系统用户， 进入到用户根目录下\nmkdir .ssh          # 创建目录.ssh\ncd .ssh             # 进入.ssh目录下\nssh-keygen          # 默认直接回车情况下， 创建私钥id_rsa和公钥id_rsa.pub两个文件， 且私钥密码为空\nssh-keygen -t rsa   # -t表示指明生成ras的私钥和公钥\nssh-keygen -t rsa -C \"我的SSH密钥\"  # -C表示添加密钥的注释\n```\n\n\n#### 4. 检测ssh key通过\n\n命令`ssh -T git@xxx.com`, 其中， xxx.com是代码托管网站的网站\n```\nssh -T git@gitlab.com\nWelcome to GitLab, @zhuxiongxian!\n```\n\n#### 5. 查看配置信息\n\n```\ngit config --list   # 查看本地仓库的git配置信息\ngit config -l       # 同上， --list参数可简写为-l\ngit config --global -l # 查看全局的git配置信息， --global表示全局\n```\n\n#### 6. git之https或http方式设置记住用户名和密码\n\nhttps方式每次都要输入密码，按照如下设置即可输入一次就不用再手输入密码的困扰而且又享受https带来的极速\n\n全局设置记住密码（默认15分钟）：\n\n```\ngit config --global credential.helper cache\n```\n\n全局设置长期存储密码：\n\n```\ngit config --global credential.helper store\n```\n\n本地设置长期存储密码， 在项目根目录下执行以下命令：\n\n```\ngit config credential.helper store\n```\n或者在本地的工程文件夹的.git下打开config文件， 在文件`project/.git/config`添加：\n\n```\n[credential]\n    helper = store\n```\n\n再输入一次用户名密码后就可以保存住了。\n\n#### 7. 更新代码/拉取代码\n\n```\ngit pull\ngit pull origin <remote_branch>\ngit pull origin <remote_branch>:<local_branch>\n```\n\n#### 8. 查看有内容变更的文件\n\n```\ngit status\n```\n\n#### 9. 提交代码/上传代码\n\n```\ngit add .\ngit commit -m \"推送的消息\"\ngit push origin master  # 推送本地代码到远程版本库上\ngit push -u origin master   # 第一次推送本地代码到远程版本库上\ngit push origin master -f   # 强行推送本地代码到远程版本库上， -f表示force， 强行或强制的意思\n```\n\n#### 10. 合并冲突\n\n```\ngit add .\ngit commit -m \"update\"\ngit pull\n\n# 如果自动全并成功， 则直接push; \ngit push origin master\n# 如果自动合并失败， 在手动解决冲突后， 还要add--commit--push\ngit add .\ngit commit -m \"update\"\ngit push origin master\n```\n\n#### 11. 手动解决冲突并提交代码\n\n```\ngit add .\ngit commit -m \"update\"\ngit pull\n```\n\n此时报错， 英文提示合并失败， 并告诉你冲突的文件是哪些， 这时需要你手动解决冲突， 找到英文提示合并冲突的文件， 找到以下行：\n\n```\n<<<<<<< HEAD\nCreating a new branch is quick & simple.\n=======\nCreating a new branch is quick AND simple.\n>>>>>>> feature1\n```\n\np.s. \n\n- `<<<<<<< HEAD` 与 `=======` 表示本地版本库的冲突内容\n- `=======` 与 `>>>>>>> feature1` 表示远程版本库的冲突内容\n\n手动解决完冲突后， 再执行提交代码操作：\n\n```\ngit add .\ngit commit -m \"update\"\ngit push origin master\n```\n\n#### 12. git检查本地的代码修改情况\n\n```\ngit diff # 可以查看当前没有add 的内容修改（不在缓冲区的文件变化）\ngit diff --cached # 查看已经add但没有commit 的改动（在缓冲区的文件变化）\ngit diff HEAD # 是上面两条命令的合并\n```\n\n#### 13. Git pull 强行覆盖本地文件\n\n```\ngit fetch --all\ngit reset --hard origin/master\ngit pull\n```\n\n#### 14. git tag 标签(版本)的操作\n\n- 创建标签： `git tag 标签名`\n- 显示所有标签： `git tag`\n- 共享所有标签到远程库： `git push --tags` # p.s. 如果有人克隆或者在线同步你的git仓库的话， 标签也会一并同步了\n- 删除本地标签： `git tag -d 标签名`\n- 删除远程标签： `git push origin :refs/tags/标签名`\n- 检出标签： `git checkout 标签名`\n- 查看相应标签的版本信息， 并连同显示标签的提交对象： `git show 标签名`\n- 推送标签： `git push origin 标签名`\n- 查看提交的历史日志: `git log`\n- 重命名标签： `git tag 新标签 旧标签`\n\n示例：\n\n```\ngit tag             # 显示所有的标签\ngit tag v0.1.0      # 本地创建新的标签(版本)\ngit push --tags     # 将本地的所有版本(标签)推送到远程库上(即共享标签)\ngit push origin v0.1.0 # 只推送标签v0.1.0到远程库上\n```\n\n#### 15. git branch 分支的操作\n\n```\ngit branch            # 显示所有分支\ngit checkout 分支名    # 检出分支/切换到分支\n```\n\n#### 16. 查看修改了哪些文件\n\n```\ngit status\n```\n\n#### 17. 查看修改了哪些文件及内容\n\n```\ngit diff\n```\n\n#### 18. 查看源\n\n```\ngit remote -v\n```\n\n#### 19. 删除源\n\n```\ngit remote rm origin\n```\n\n#### 20. 添加源\n\n若源`https://github.com/xiongxianzhu/qingmi.git`, 示例如下:\n\n```\ngit remote add origin https://github.com/xiongxianzhu/qingmi.git\n```\n\n#### 21. 创建并切换分支\n\n创建dev分支，然后切换到dev分支：\n\n```\n$ git checkout -b dev\nSwitched to a new branch 'dev'\n```\n\n`git checkout`命令加上`-b`参数表示创建并切换，相当于以下两条命令：\n\n```\n$ git branch dev\n$ git checkout dev\nSwitched to branch 'dev'\n```\n\n然后，用git branch命令查看当前分支：\n\n```\n$ git branch\n* dev\n  master\n```\n\n`git branch`命令会列出所有分支，当前分支前面会标一个*号。\n然后，我们就可以在dev分支上正常提交， 示例：\n\n```\n$ git add .\n$ git commit -m 'update'\n$ git push --set-upstream origin dev\nCounting objects: 4, done.\nDelta compression using up to 6 threads.\nCompressing objects: 100% (3/3), done.\nWriting objects: 100% (4/4), 1.27 KiB | 0 bytes/s, done.\nTotal 4 (delta 2), reused 0 (delta 0)\nTo git@gitlab.com:quwei/docs.git\n* [new branch]      dev -> dev\nBranch dev set up to track remote branch dev from origin.\n```\n\n#### 22. 合并分支\n\n`dev`分支的工作完成，我们就可以切换回`master`分支：\n\n```\n$ git checkout master\nSwitched to branch 'master'\n```\n\n现在，我们把`dev`分支的工作成果合并到`master`分支上：\n\n```\n$ git merge dev\nUpdating d46f35e..b17d20e\nFast-forward\n readme.txt | 1 +\n 1 file changed, 1 insertion(+)\n```\n\n`git merge`命令用于合并指定分支到当前分支\n\n#### 23. 删除分支\n\n若合并完成后，不需要dev分支， 就可以放心地删除dev分支了：\n\n```\n$ git branch -d dev\nDeleted branch dev (was b17d20e).\n```\n\n删除后，查看branch，就只剩下master分支了：\n\n```\n$ git branch\n* master\n```\n\n上面是删除本地分支， 若删除远程分支， 如下:\n\n```\ngit push origin --delete dev\n```\n\n就可以把分支dev从远程库中删除了。\n\n#### 24. 把分支master内容更新到分支dev\n\n```\ngit checkout dev\ngit merge master\n```\n\n#### 25. 重命名分支\n\n查看所有分支， 将本地分支`dev`重命名为`xx`， 删除远程分支， 将本地分支推送到远程库:\n\n```\ngit branch\ngit branch -m dev xx\ngit push --delete origin dev\ngit push origin xx\n```\n\n#### 26. 分支小结\n\nGit鼓励大量使用分支：\n\n查看分支：`git branch`\n\n创建分支：`git branch <name>`\n\n切换分支：`git checkout <name>`\n\n创建+切换分支：`git checkout -b <name>`\n\n合并某分支到当前分支：`git merge <name>`\n\n删除本地分支：`git branch -d <name>`\n\n删除远程分支：`git push origin --delete <name>`\n\n#### 27. 禁用git filemode\n\n```\ngit config core.filemode false\n```\n\n或编辑仓库下的`仓库名/.git/config`文件， `git config -e`or`vim .git/config`\n\n```\n[core]\n    filemode = false\n```\n\n#### 28. 修改源\n\n```\ngit remote set-url origin [NEW_URL]\n```\n\n或在项目根目录下， 修改配置文件：\n\n```\ncd .git\nvim config\n```\n\n内容如下：\n\n```\n[core]\n    repositoryformatversion = 0\n    filemode = false\n    bare = false\n    logallrefupdates = true\n    ignorecase = true\n    precomposeunicode = true\n[remote \"origin\"]\n    # 修改成新的仓库地址\n    url = git@bitbucket.org:zhuxiongxian/blog.git\n    fetch = +refs/heads/*:refs/remotes/origin/*\n[branch \"master\"]\n    remote = origin\n    merge = refs/heads/master\n\n```\n\n#### 29. 简写git push origin 分支名\n\n如当前分支名为 `xx`， 想在当前分支`xx`下简写`git push origin xx`为`git push`， 则：\n\n```\ngit push --set-upstream origin xx\n```\n\n其中， `xx`是分支名， 您需要替换为您的分支名即可。\n\n#### 30. 撤销本地的修改\n\n```\ngit restore 文件名\ngit restore .\n```\n\n#### 31. fatal: 拒绝合并无关的历史\n\n使用参数`--allow-unrelated-histories`:\n\n```bash\n$ git merge main\nfatal: 拒绝合并无关的历史\n$ git merge main --allow-unrelated-histories\n```\n\n#### 32. 回滚代码\n\n```bash\ngit tag\ngit show 1.0.0          # 得到commit_id\n\n# 得到commit_id后，则可以通过git reset回滚到commit_id\ngit reset --hard <commit_id>\ngit reset --hard 357598e77fa2b6fa04c543e424c86230e30cf925\n\ngit push origin <分支名> -f\n\n或\n\ngit push -f\n```\n\n注意，若强推不上master，则可能master被设置为保护分支，需要到相应的git网站，到该仓库下的设置--保护分支，将master移除出保护分支或允许你的git账户角色有强推到master的权限，保存设置后，再重新强推即可。\n\n在生产环境的主机上，对源码回滚：\n\n```bash\ngit checkout master\ngit pull\ngit reset --hard origin/master\n```\n","tags":["git","ssh-keygen"],"categories":["git"]},{"title":"Linux安装与卸载MongoDB","url":"/2018/02/01/install-or-uninstall-mongodb-on-linux/","content":"\n官方安装MongoDB英文教程： <https://docs.mongodb.com/getting-started/shell/installation/>\n\np.s. 本文针对64位的linux发行版本。\n\n#### 1. Ubuntu下安装或卸载MongoDB\n\n##### 1.1. 包管理系统APT添加MongoDB公钥key\n\n使用ubuntu的包管理系统(即dpkg和APT)导入公钥：\n\n```bash\n$ sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 2930ADAE8CAF5059EE73BB4B58712A2291FA4AD5\n```\n\nMongoDB的公钥Key会更新， 最新的公钥只能在官网Ubuntu系统下安装MongoDB的页面中查找：\n<https://docs.mongodb.com/master/tutorial/install-mongodb-on-ubuntu/>\n\n任选以上其中一个公钥， 执行命令回车添加即可。\n\n##### 1.2. 创建MongoDB软件源文件\n\n添加MongoDB软件源：\n\n```bash\n$ vim /etc/apt/sources.list.d/mongodb.list\n```\n\n`mongodb.list`文件内容由ubuntu的版本决定。 ubuntu版本的命令规则是根据正式版发行的年月命名， ubuntu16.04也就意味着2016年04月发行。 除此之处， 每个版本的ubuntu还有一个用2个英文单词组成的开发代号， 都是动物名称组成。 安装软件源的版本则需要对应一下。\n\np.s. ubuntu版本每半年(即6个月)发布一个版本， 每2年发布一个长期支持`LTS(Long Term Support)`版本。\n\nubuntu12.04版本的代号是穿山甲 `Precise Pangolin`, 则输入内容是：\n\n```\ndeb [ arch=amd64 ] https://repo.mongodb.org/apt/ubuntu precise/mongodb-org/3.6 multiverse\n```\n\nubuntu14.04版本的代号是塔尔羊 `Trusty Tahr`, 则输入内容是：\n\n```\ndeb [ arch=amd64 ] https://repo.mongodb.org/apt/ubuntu trusty/mongodb-org/3.6 multiverse\n```\n\nubuntu16.04版本的代号是地松鼠 `Xenial Xerus`, 则输入内容是：\n\n```\ndeb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.6 multiverse\n```\n\np.s. 知道了配置软件源的原理之后， 这里提供了一种快速配置的方法， 不需要文本编辑器 `vim` 输入， `echo` 和 `tee` 命令可以把内容输入到文件中。 `lsb_release -sc` 则可以自动提取版本动物名， 所以以下命令可以替代上面的 `vim` 输入内容的方法。\n\n直接输入命令：\n\n```bash\necho \"deb https://repo.mongodb.org/apt/ubuntu \"$(lsb_release -sc)\"/mongodb-org/3.6 multiverse\" | sudo tee /etc/apt/sources.list.d/mongodb.list\n```\n\n官方MongoDB的软件源仓库可以对大陆用户不太友好， 建议使用阿里云的MongoDB软件源仓库， 执行以下命令：\n\n```\necho \"deb http://mirrors.aliyun.com/mongodb/apt/ubuntu \"$(lsb_release -sc)\"/mongodb-org/3.6 multiverse\" | sudo tee /etc/apt/sources.list.d/mongodb.list\n```\n\n若想删除mongodb软件源， 则直接用`rm`命令从软件源目录下删除`mongodb.list`， 如下：\n\n```\n$ sudo rm -fr /etc/apt/sources.list.d/mongodb.list\n```\n\n##### 1.3. 更新软件源\n\nubuntu的软件源文件都存放在目录 `/etc/apt/sources.list.d/` 下， 执行以下命令扫描新增的mongodb软件源文件`mongodb.list`：\n\n```\n$ sudo apt-get update\n```\n\n##### 1.4. 安装MongoDB\n\n```\n$ sudo apt-get install -y mongodb-org\n```\n参数`-y`表示yes, 意味着中途不用确认， 直接自动安装。\n\n##### 1.5. 卸载MongoDB\n\n```\n$ sudo service mongod stop\n$ sudo apt-get purge mongodb-org*\n\n$ sudo apt-get autoremove\n$ sudo rm -r /var/log/mongodb (日志目录)\n$ sudo rm -r /var/lib/mongodb (数据目录)\n```\n\n##### 1.6. MongoDB相关说明\n\n- mongodb默认服务名为： `mongod`\n- mongodb默认的数据文件目录为： `/var/lib/mongodb`\n- mongodb默认的日志文件目录为： `/var/log/mongodb`\n- mongodb默认的配置文件为： `/etc/mongod.conf`\n- mongodb默认的端口为：`27017`\n- 配置文件可指定日志(systemLog.path)和数据文件目录(storage.dbPath)， 以及端口等。\n- mongodb默认的运行日志文件： `/var/log/mongodb/mongod.log`\n\n##### 1.7. 设置MongoDB服务开机启动\n\n安装mongodb3.6版本默认会在目录`/lib/systemd/system/`下创建MongoDB的服务文件`mongod.service`， 如果没有则手动在`/lib/systemd/system/`下创建文件`mongod.service`， 如下：\n\n```bash\n# cd /lib/systemd/system/\n# vim mongod.service\n```\n\n`mongod.service`文件内容如下：\n\n```\n[Unit]\nDescription=High-performance, schema-free document-oriented database\nAfter=network.target\nDocumentation=https://docs.mongodb.org/manual\n\n[Service]\nUser=mongodb\nGroup=mongodb\nExecStart=/usr/bin/mongod --config /etc/mongod.conf\nPIDFile=/var/run/mongodb/mongod.pid\n# file size\nLimitFSIZE=infinity\n# cpu time\nLimitCPU=infinity\n# virtual memory size\nLimitAS=infinity\n# open files\nLimitNOFILE=64000\n# processes/threads\nLimitNPROC=64000\n# locked memory\nLimitMEMLOCK=infinity\n# total threads (user+kernel)\nTasksMax=infinity\nTasksAccounting=false\n\n# Recommended limits for for mongod as specified in\n# http://docs.mongodb.org/manual/reference/ulimit/#recommended-settings\n\n[Install]\nWantedBy=multi-user.target\n```\n\n或简化为：\n\n```\n[Unit]\nDescription=High-performance, schema-free document-oriented database\nAfter=network.target\nDocumentation=https://docs.mongodb.org/manual\n\n[Service]\nUser=mongodb\nGroup=mongodb\nExecStart=/usr/bin/mongod --quiet --config /etc/mongod.conf\n\n[Install]\nWantedBy=multi-user.target\n```\n\n`:wq`保存退出vim编辑文件`mongod.service`， 更新`systemctl`服务：\n\n```\n# systemctl daemon-reload\n```\n\nMongoDB的服务名为`mongod`, 执行以下命令实现开机启动：\n\n```\n# systemctl start mongod\n# systemctl enable mongod\nCreated symlink from /etc/systemd/system/multi-user.target.wants/mongod.service to /lib/systemd/system/mongod.service.\n$ sudo update-rc.d -f mongod defaults\n```\n\n检测MongoDB服务`mongod`是否以端口`27017`启动：\n\n```\n# netstat -plntu\n或\n# ps aux|grep mongod\n或\n# lsof -i:27017\n或 \n# pgrep mongo -l # 注意：-l是英文字母l，不是阿拉伯数字1， 显示进程号和进程名\n1095 mongod\n```\n\n查看MongoDB版本：\n\n```\n$ mongod --version\ndb version v3.6.2\ngit version: 489d177dbd0f0420a8ca04d39fd78d0a2c539420\nOpenSSL version: OpenSSL 1.0.2g  1 Mar 2016\nallocator: tcmalloc\nmodules: none\nbuild environment:\n    distmod: ubuntu1604\n    distarch: x86_64\n    target_arch: x86_64\n```\n\n删除mongod开机启动执行命令：\n\n```\n$ sudo update-rc.d -f mongod remove\n```\n\n\n#### 2. Centos下安装或卸载MongoDB\n\n[install-mongodb-on-red-hat](https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/)\n\n##### 2.1. 安装MongoDB\n\n当前最新稳定版本为`3.6.5`， 则选择安装最新稳定版的mongodb\n\n安装mongodb, 会安装软件包`mongodb-org`及其依赖包`mongodb-org-server`、`mongodb-org-mongos`、`mongodb-org-shell`、`mongodb-org-tools`。\n\n创建MongoDB软件源文件 `/etc/yum.repos.d/mongodb-org-3.6.repo`， 其内容为：\n\n```\n[mongodb-org-3.6]\nname=MongoDB Repository\nbaseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.6/x86_64/\ngpgcheck=1\nenabled=1\ngpgkey=https://www.mongodb.org/static/pgp/server-3.6.asc\n```\n更新yum缓存， 并安装mongodb\n```\n$ sudo yum update\n$ sudo yum install -y mongodb-org\n$ mongo --version\nMongoDB shell version v3.6.5\ngit version: a20ecd3e3a174162052ff99913bc2ca9a839d618\nOpenSSL version: OpenSSL 1.0.1e-fips 11 Feb 2013\nallocator: tcmalloc\nmodules: none\nbuild environment:\n    distmod: rhel70\n    distarch: x86_64\n    target_arch: x86_64\n```\n\n##### 2.2. 卸载MongoDB\n\n```\n$ sudo systemctl stop mongod  // sudo service mongod stop\n$ sudo yum erase $(rpm -qa | grep mongodb-org)\n$ sudo rm -r /var/log/mongodb\n$ sudo rm -r /var/lib/mongo\n```\n\n##### 2.3. 设置MongoDB服务开机启动\n\n```\n$ sudo chkconfig mongod on\n```\n\n##### 2.4. mongodb服务管理\n\n```\n$ sudo systemctl start mongod   // 开启mongod服务\n$ sudo systemctl restart mongod // 重启mongod服务\n$ sudo systemctl stop mongod    // 停止mongod服务\n```\n\n相关阅读：\n\n- [mongodb shell常用命令](https://zhuxiongxian.cc/2017/06/23/mongodb-shell-common-commands/)","tags":["linux","mongodb","nosql","数据库","运维"],"categories":["mongodb"]},{"title":"hexo常用命令","url":"/2018/01/26/hexo-command/","content":"\nhexo中文官网： <https://hexo.io/zh-cn/>\nhexo中文官方文档： <https://hexo.io/zh-cn/docs/>\n\n#### 1. hexo安装\n\n```\n$ npm install hexo -g\n或\n$ cnpm i hexo -g    # cnpm代替npm时\n```\n\np.s. \n\n- 需要提前安装nodejs环境， 配置node, npm环境变量。\n\n#### 2. hexo新建博客\n\n```\n$ hexo init blog\n或\n$ mkdir blog\n$ cd blog\n$ hexo init\n```\n\np.s. \n\n- 生成blog目录，blog目录包含node_modules、scaffolds、source、themes、.gitignore、_config.yml、db.json、package.json，其中 _config.yml 为全局配置文件。\n\n#### 3. hexo服务\n\n```\n$ hexo server       # 开启预览访问端口（默认端口4000，'ctrl + c'关闭server）\n$ hexo s\n$ hexo s --debug\n```\n\np.s.\n\n- `hexo server`简写成`heox s`\n- 默认端口是`4000`\n- 参数`--debug`调试模式， 可以显示运行日志信息\n\n#### 4. 新建文件夹\n\n```\n$ hexo new page folder\n$ hexo new page \"folder\"\n$ hexo n page folder\n$ hexo n page \"folder\"\n```\n\np.s.\n\n- `hexo new`简写成`hexo n`， 推荐使用简写， 还一句话， 方便简洁高效， 怎么方便怎么来\n- 格式： `hexo n page 目录名`， 可以不加双引号， 若有特定符号， 建议加上双引号\n\n#### 5. 新建文章\n\n```\n$ hexo new file\n$ hexo new \"file\"\n$ hexo n file\n$ hexo n \"file\"\n```\n\np.s.\n\n- 格式： `hexo n 文件名/文章名`\n- 新建的文件会保存在 `_posts` 目录里\n\n#### 6. 新建草稿文章\n\n```\n$ hexo new draft file\n$ hexo new draft \"file\"\n$ hexo n draft file\n$ hexo n draft \"file\"\n```\n\np.s.\n\n- 格式： `hexo n draft 文件名/草稿文件名`\n- 新建的草稿文章会保存在 `_drafts` 目录里\n- 草稿默认不会显示在页面中，您可在执行时加上 --draft 参数，或是把 render_drafts 参数设为 true 来预览草稿\n\n#### 7. 发表草稿文章\n\n```\n$ hexo publish [layout] file\n$ hexo p file\n```\n\np.s. \n\n- 格式： `hexo p 文件名/草稿文件名`\n- `hexo publish`简写为`hexo p`\n\n如： `hexp n [file]`创建了新文章， 在编辑完后， 再执行`hexp p [file]`发表草稿文章:\n\n```\n$ hexo n \"ubuntu16.04安装mysql5.7.24\"\n$ hexo p \"ubuntu16.04安装mysql5.7.24\"\n```\n\n#### 8. 生成静态网页\n\n使用 Hexo 生成静态文件快速而且简单。\n\n```\n$ hexo clean                # 清除缓存 网页正常情况下可以忽略此条命令\n$ hexo generate             # 生成静态页面至public目录\n$ hexo g\n$ hexo generate --watch     # 参数--watch表示监视文件变动\n$ hexo g --watch\n```\n\np.s.\n\n- `hexo generate`简写为`hexo g`\n- 参数`--watch`是使Hexo 能够监视文件变动并立即重新生成静态文件，在生成时会比对文件的 SHA1 checksum，只有变动的文件才会写入。\n\n#### 9. 部署\n\n```\n$ hexo deploy      #将.deploy目录部署到代码托管库服务器上\n$ hexo d\n```\n\np.s.\n\n- `hexo deploy`简写为`hexo d`\n\n#### 10. 生成后并推送部署到服务器上\n\n您可执行下列的其中一个命令，让 Hexo 在生成完毕后自动部署网站，两个命令的作用是相同的。\n\n```\n$ hexo generate --deploy\n$ hexo deploy --generate\n```\n\n简写：\n\n```\n$ hexo g -d\n$ hexo d -g\n```","tags":["hexo","命令"],"categories":["frontend"]},{"title":"python实现简单的socket通讯","url":"/2018/01/22/python-simple-socket/","content":"\nTalk is cheap, show me the code!!!\n\n服务端`socket_server_demo01.py`代码如下：\n\n```\n# coding: utf-8\n\n\"\"\"\n    socket 服务器端\n\n    基于套接字socket的网络通信\n\"\"\"\n\nimport socket                   # 导入socket模块\n# from time import ctime\nimport time\n\n# HOST = socket.gethostname()   # 主机名, '127.0.0.1' or 'localhost'\nHOST = '127.0.0.1'              # 主机名, '127.0.0.1' or 'localhost'\nPORT = 21929                    # 设置端口号\nBUFSIZ = 1024\nADDR = (HOST, PORT)\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)   # 创建socket对象\ns.bind(ADDR)                    # 将地址(主机名/端口号对)绑定到套接字上\ns.listen(5)                     # 设置并启动TCP监听器\n\nwhile True:\n    print 'waiting for connection...'\n    c, addr = s.accept()        # 被动接受TCP客户端连接， 一直等待直到连接到达(阻塞)\n    print '...connected from: ', ADDR     # 打印连接地址\n\n    while True:\n        data = c.recv(BUFSIZ)   # 接收TCP消息\n        if not data:\n            break\n        # c.send('[%s] %s' % (ctime(), data))\n        # c.send('[{}] {}'.format(str(ctime()), data))    # 发送TCP消息\n        c.send('[{}] {}'.format(time.strftime(\"%Y-%m-%d %H:%M:%S %A\", \\\n                time.localtime()), data))    # 发送TCP消息\n    c.close()               # 关闭套接字(关闭连接)\nc.close()                   # 关闭套接字(关闭连接)\n\n```\n客户端`socket_client_demo01.py`代码如下：\n\n```\n# coding: utf-8\n\n\"\"\"\n    socket 客户端\n\n    基于套接字socket的网络通信\n\"\"\"\n\nimport socket                   # 导入socket模块\n\n# HOST = socket.gethostname()   # 主机名, '127.0.0.1' or 'localhost'\nHOST = '127.0.0.1'              # 主机名, '127.0.0.1' or 'localhost'\nPORT = 21929                    # 设置端口\nBUFSIZ = 1024\nADDR = (HOST, PORT)             # 地址， `主机名+端口` 对\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)   # 创建socket对象\ns.connect(ADDR)                 # 主动发起TCP服务器连接\n\nwhile True:\n    data = raw_input('> ')      # 待输入就绪状态\n    if not data:\n        break\n    s.send(data)                # 发送输入的数据\n    data = s.recv(BUFSIZ)       # 接收TCP消息\n    if not data:\n        break                   # 若无数据输入则跳出循环\n    print data\n\ns.close()                       # 关闭套接字(关闭连接)\n\n```\n\n运行结果：\n\n![python socket网络通讯](/img/article/Selection_027.png)","tags":["python","socket","通讯","网络编程","TCP"]},{"title":"python排列组合算法应用01","url":"/2018/01/18/python-permutation-combination-demo01/","content":"\n#### 1. 题目描述\n\n每天早上打开电脑， 第一时间都会习惯性地看看今天推荐的资讯文章，时不时会看到类似于`小学生难题， 只有%3的人能做对`字眼的文章， 真的有这么难吗？\n\n细心的程序猿/媛会发现， 这无非是编程入门最基本的题目罢了。今天来看看以下这道`小学题`吧！\n\n```\n请将4, 5, 6, 7, 9, 19六个数分别填入A-F空白框中， 每个数在每条算式中只能填一次。\n满足： A + B - C = D - E - F。\n```\n如下图：\n\n![小学题目](/img/article/83779393.jpg)\n\n#### 2. 示例代码\n\n思路： \n\n- 条件`A+B-C=D-E-F`即`A+B+E+F=D+C`\n- 等号两边相加为`A+B+C+D+E+F` = 4+5+6+7+9+19 = 50\n- 即A+B+E+F=D+C=25, 所以D的值为6或19, C的值为19或6\n- 相加或相减， 两个加数或两个减数之间是等位的， 比如1+3可以写成3+1, 9-3-2可以写成9-2-3\n- 则满足条件`A+B-C=D-E-F`的写法可以通过排列算法遍历得到结果\n- 由上面的条件， 通过数学中的排列组合里的公式， 得知结果的种数等于[A, B, E, F]的排列种数 `A(4, 4)` 与[C, D]的排列种数 `A(2, 2)` 的乘积， 即`A(4, 4)` \\* `A(2, 2)` = 24 \\* 2 = 48，即满足条件的排列的写法有48种。\n\nTalk is cheap, show me the code!!!\n\nitertools_demo.py内容如下：\n\n```\n# coding: utf-8\n\nimport itertools\n\n\ndef permutation(arr, n):\n    \"\"\" 排列算法 \"\"\"\n    return list(itertools.permutations(arr, n))\n\n\ndef combination(arr, n):\n    \"\"\" 组合算法 \"\"\"\n    return list(itertools.combinations(arr, n))\n\n\ndef go():\n    \"\"\" \n        请将4, 5, 6, 7, 9, 19六个数分别填入A-F空白框中， 每个数在每条算式中只能填一次。\n        满足： A + B - C = D - E - F\n\n    \"\"\"\n    arr = [4, 5, 6, 7, 9, 19]\n    all_list = permutation(arr, 6)\n    count = 0\n    for one_list in all_list:\n        if one_list[0] + one_list[1] - one_list[2] == \\\n            one_list[3] - one_list[4] - one_list[5]:\n            # print \"%s + %s - %s = %s - %s - %s\" % tuple(i for i in one_list)\n            # print('{0[0]} + {0[1]} - {0[2]} = {0[3]} - {0[4]} - {0[5]}'.format(one_list))\n            print('{0[0]:>2} + {0[1]:>2} - {0[2]:>2} = {0[3]:>2} - {0[4]:>2} - {0[5]:>2}'.format(one_list))\n            count += 1\n    print \"共有%s种排列的写法。\" % count\n\nif __name__ == \"__main__\":\n    go()\n```\n运行结果如下：\n\n```\n$ python itertools_demo.py \n 4 +  5 -  6 = 19 -  7 -  9\n 4 +  5 -  6 = 19 -  9 -  7\n 4 +  5 - 19 =  6 -  7 -  9\n 4 +  5 - 19 =  6 -  9 -  7\n 4 +  7 -  6 = 19 -  5 -  9\n 4 +  7 -  6 = 19 -  9 -  5\n 4 +  7 - 19 =  6 -  5 -  9\n 4 +  7 - 19 =  6 -  9 -  5\n 4 +  9 -  6 = 19 -  5 -  7\n 4 +  9 -  6 = 19 -  7 -  5\n 4 +  9 - 19 =  6 -  5 -  7\n 4 +  9 - 19 =  6 -  7 -  5\n 5 +  4 -  6 = 19 -  7 -  9\n 5 +  4 -  6 = 19 -  9 -  7\n 5 +  4 - 19 =  6 -  7 -  9\n 5 +  4 - 19 =  6 -  9 -  7\n 5 +  7 -  6 = 19 -  4 -  9\n 5 +  7 -  6 = 19 -  9 -  4\n 5 +  7 - 19 =  6 -  4 -  9\n 5 +  7 - 19 =  6 -  9 -  4\n 5 +  9 -  6 = 19 -  4 -  7\n 5 +  9 -  6 = 19 -  7 -  4\n 5 +  9 - 19 =  6 -  4 -  7\n 5 +  9 - 19 =  6 -  7 -  4\n 7 +  4 -  6 = 19 -  5 -  9\n 7 +  4 -  6 = 19 -  9 -  5\n 7 +  4 - 19 =  6 -  5 -  9\n 7 +  4 - 19 =  6 -  9 -  5\n 7 +  5 -  6 = 19 -  4 -  9\n 7 +  5 -  6 = 19 -  9 -  4\n 7 +  5 - 19 =  6 -  4 -  9\n 7 +  5 - 19 =  6 -  9 -  4\n 7 +  9 -  6 = 19 -  4 -  5\n 7 +  9 -  6 = 19 -  5 -  4\n 7 +  9 - 19 =  6 -  4 -  5\n 7 +  9 - 19 =  6 -  5 -  4\n 9 +  4 -  6 = 19 -  5 -  7\n 9 +  4 -  6 = 19 -  7 -  5\n 9 +  4 - 19 =  6 -  5 -  7\n 9 +  4 - 19 =  6 -  7 -  5\n 9 +  5 -  6 = 19 -  4 -  7\n 9 +  5 -  6 = 19 -  7 -  4\n 9 +  5 - 19 =  6 -  4 -  7\n 9 +  5 - 19 =  6 -  7 -  4\n 9 +  7 -  6 = 19 -  4 -  5\n 9 +  7 -  6 = 19 -  5 -  4\n 9 +  7 - 19 =  6 -  4 -  5\n 9 +  7 - 19 =  6 -  5 -  4\n共有48种排列的写法。\n```","tags":["python","排列","组合"],"categories":["python"]},{"title":"二叉树前中后序遍历快速入门","url":"/2018/01/08/binary-tree-traversal/","content":"\n#### 1. 遍历顺序\n\n遍历是对树的一种最基本的运算，所谓遍历二叉树，就是按一定的规则和顺序走遍二叉树的所有结点，使每一个结点都被访问一次，而且只被访问一次。由于二叉树是`非线性结构`，因此，树的遍历实质上是将二叉树的各个结点转换成为一个`线性序列`来表示。\n\np.s. 前序遍历又叫先序遍历.\n\n前中后序遍历顺序如下：\n\n> 前序遍历：根节点->左子树->右子树 (根左右)\n\n> 中序遍历：左子树->根节点->右子树 (左根右)\n\n> 后序遍历：左子树->右子树->根节点 (左右根)\n\n##### 1.1. 前序遍历\n\n前序遍历： 先遍历根结点，然后遍历左子树，最后遍历右子树。\n\n##### 1.2. 中序遍历\n\n中序遍历： 先遍历左子树，然后遍历根结点，最后遍历右子树。\n\n##### 1.3. 后序遍历\n\n后序遍历： 先遍历左子树，然后遍历右子树，最后遍历根节点。\n\n##### 1.4. 层次遍历\n\n层次遍历： 即按照层次访问，通常用队列来做。访问根，访问子女，再访问子女的子女（越往后的层次越低）（两个子女的级别相同）。\n\n#### 2. 画二叉树\n\n前序（前根序列）： 根左右\n中序（中根序列）： 左根右\n后序（后根序列）： 左右根\n\n只要知道中序遍历顺序， 再加上前序或后序任一个遍历顺序即可确定唯一的二叉树。\n\n画二叉树口诀： \n\n```\n前后序定根， 中序定左右;\n前序前找根， 后序后找根。\n```\n\n例如已知：\n\n```\n中根序列： C, B, D, E, A, G, I, H, J, F\n后根序列： C, E, D, B, I, J, H, G, F, A\n画出二叉树并写出前根序列。\n```\n\n解答思路：\n\n```\n1. 根据前序或后序先确定根;\n2. 再根据中序确定左右子树。\n```\n\n按递归思想， 根据口诀逐一分步成思路中的1, 2步， 即可快速画出如下二叉树：\n\n![二叉树](/img/article/binary_tree_1.png)\n\n由得出的二叉树可知前根序列为：A, B, C, D, E, F, G, H, I, J\n","tags":["数据结构","二叉树","前序","中序","后序"],"categories":["数据结构与算法"]},{"title":"linux安装jdk8","url":"/2017/12/13/linux-jdk8/","content":"\n本文安装jdk1.8适用于linux的主流发行版本如ubuntu, centos等。\n\n#### 1. jdk8下载\n\njdk8下载地址：\n\n```\nhttp://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html\n```\n\nwget命令下载：\n\n```\n$ wget -c \"http://download.oracle.com/otn-pub/java/jdk/8u151-b12/e758a0de34e24606bca991d704f6dcbf/jdk-8u151-linux-x64.tar.gz?AuthParam=1513164187_944e5381813d3894c7b0be252df22984\"\n```\n    \n文件重命名得到`jdk-8u151-linux-x64.tar.gz`:\n\n```\n# mv jdk-8u151-linux-x64.tar.gz?AuthParam=1513164187_944e5381813d3894c7b0be252df22984 jdk-8u151-linux-x64.tar.gz\n\n```\n\n#### 2. 解压缩\n\n解压`jdk-8u151-linux-x64.tar.gz`得到目录`jdk1.8.0_151`:\n\n```\n# tar -xzvf jdk-8u121-linux-x64.tar.gz\n```\n\n#### 3. 指定jdk的安装目录\n\n创建目录`/usr/java/`\n\n```\n# mkdir /usr/java\n```\n\n移动目录`jdk1.8.0_151`到`/usr/java/`下：\n\n```\n# mv jdk1.8.0_151/ /usr/java/\n# cd /usr/java/\n# ls\njdk1.8.0_151\n```\n\n#### 4. 配置环境变量\n\n修改文件`/etc/profile`\n\n```\n# vim /etc/profile\n```\n\n在`/etc/profile`文件内容最后追加:\n\n```\nexport JAVA_HOME=/usr/java/jdk1.8.0_151\nexport CLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar\nexport PATH=$PATH:$JAVA_HOME/bin\n```\n\n`:wq`保存退出\n使文件`/etc/profile`重新生效\n\n```\n# source /etc/profile\n```\n\n#### 5. 检测jdk8是否成功安装\n\n```\n$ java -version\njava version \"1.8.0_151\"\nJava(TM) SE Runtime Environment (build 1.8.0_151-b12)\nJava HotSpot(TM) 64-Bit Server VM (build 25.151-b12, mixed mode)\n$ \n```\n\n#### 6. 注意事项\n\n对于zsh用户， 在安装配置完jdk后， 还需要注销重新登录系统才能正常使用`java`等命令。\n\n这是因为`java`命令在目录`/usr/bin/`下， zsh配置文件`~/.zshrc`需要注销重新登录用户使环境变量生效：\n\n`$ vim .bash_profile`:\n\n```\nexport PATH=/bin:/usr/bin:/usr/local/bin:$PATH\n```\n\n激活命令`java`, 使`java`命令在每次开机登录系统时在`zsh shell`下都能生效:\n\n```\n$ source .bash_profile\n$ echo source ~/.bash_profile >> ~/.zshrc\n```\n\n若在文件`~/.zshrc`添加过`source ~/.bash_profile`， 则无需重新添加。\n\nOk， Enjoy it~\n","tags":["linux","jdk","centos","ubuntu","java"],"categories":["Java"]},{"title":"python fabric自动化部署","url":"/2017/11/09/python-fabric-automation-deployment/","content":"\nFabric是一个Python（2.5-2.7）库和命令行工具，可以通过SSH在多个host上批量执行任务, 用于简化应用程序部署或系统管理任务的SSH使用。\n\nfabric官方英文文档: <http://www.fabfile.org/>\n\n#### 1. pip安装\n\n详见[linux下pip的安装及常用命令](https://zhuxiongxian.cc/2017/11/09/linux-pip/)\n\n#### 2. fabric安装\n\n建议在虚拟环境virtualenv或virtualenvwrapper下安装fabric\n\n    # pip install fabric\n\n安装完fabric即可使用`fab`命令\n\n\n#### 3. fabric变量\n\n`from fabric.api import env`\n\n- env.user： 用于登录服务器的用户名\n- env.password： 用户名对应的密码\n- env.hosts： 服务器的 IP 地址，也可以是解析到这个 IP 的域名\n- env.port： SSH 远程服务器的端口号\n\n#### 4. fabric传参\n\np.s. 默认文件名为`fabfile.py`文件名不为`fabfile.py`时需使用`-f`进行指定.\n\n\n`vim fabfile.py`:\n\n```\ndef hello(name):\n    print 'Hello %s!'%name\n```\n\n以下两种方式可以传参：\n\n```\n$ fab hello:name=fab\nHello fab!\n \n$ fab hello:fab\nHello fab!\n```\n\n#### 5. 本地操作\n\n执行本地操作命令使用`local`\n\n`vim fabfile.py`:\n\n```\n# coding: utf-8\n\nfrom fabric.api import local\n\ndef test():\n    local('cd /home/')  \n    local('ls -l|wc -l')\n```\n执行`fab test`, 结果如下：\n```\n$ fab test\n[localhost] local: cd /home/\n[localhost] local: ls -l|wc -l\n16\n\nDone.\n```\n\n\n#### 6. 远程操作\n\n执行远程操作命令使用`run`\n\n未完， 待续...","tags":["linux","python","fabric","自动化部署"],"categories":["python"]},{"title":"linux下pip的安装及常用命令","url":"/2017/11/09/linux-pip/","content":"\npip是一个用来安装和管理Python包的工具， 它是`easy_install`的替代品， 也是目前社区的主流工具。\n\n第三方包主要分布在The Python Package Index (https://pypi.org) 官方的仓库(简称 PYPI), Github, Bitbucker等代码托管服务上。\n\n- pip官方文档： <https://pip.readthedocs.io/en/stable/>\n\n#### 1. pip安装\n\nubuntu下pip安装：\n\n```\n$ sudo apt-get install python-pip -y\n```\n\ncentos下pip安装：\n\n```\n# yum install python-pip -y\n```\n\npip脚本一键安装：\n\n```\n$ wget c- https://bootstrap.pypa.io/get-pip.py\n# python get-pip.py\n# ln -s /usr/local/python2.7/bin/pip /usr/bin/pip\n```\n\n系统自带的pip版本比较低， 可使用pip的自更新来升级：\n\n```\n$ sudo pip install pip -U -q    # -q表示静默安装， 减少过程输出\n```\n\n#### 2. 检查pip版本\n\n```\n$ pip -V    # 或 pip --version\npip 9.0.1 from /home/xx/.local/lib/python2.7/site-packages (python 2.7)\n```\n\n#### 3. pip用法\n\n```\nUsage:   \n  pip <command> [options]\n\nCommands:\n  install                     Install packages.\n  download                    Download packages.\n  uninstall                   Uninstall packages.\n  freeze                      Output installed packages in requirements format.\n  list                        List installed packages.\n  show                        Show information about installed packages.\n  check                       Verify installed packages have compatible dependencies.\n  search                      Search PyPI for packages.\n  wheel                       Build wheels from your requirements.\n  hash                        Compute hashes of package archives.\n  completion                  A helper command used for command completion.\n  help                        Show help for commands.\n\nGeneral Options:\n  -h, --help                  Show help.\n  --isolated                  Run pip in an isolated mode, ignoring\n                              environment variables and user configuration.\n  -v, --verbose               Give more output. Option is additive, and can be\n                              used up to 3 times.\n  -V, --version               Show version and exit.\n  -q, --quiet                 Give less output. Option is additive, and can be\n                              used up to 3 times (corresponding to WARNING,\n                              ERROR, and CRITICAL logging levels).\n  --log <path>                Path to a verbose appending log.\n  --proxy <proxy>             Specify a proxy in the form\n                              [user:passwd@]proxy.server:port.\n  --retries <retries>         Maximum number of retries each connection should\n                              attempt (default 5 times).\n  --timeout <sec>             Set the socket timeout (default 6000.0 seconds).\n  --exists-action <action>    Default action when a path already exists:\n                              (s)witch, (i)gnore, (w)ipe, (b)ackup, (a)bort.\n  --trusted-host <hostname>   Mark this host as trusted, even though it does\n                              not have valid or any HTTPS.\n  --cert <path>               Path to alternate CA bundle.\n  --client-cert <path>        Path to SSL client certificate, a single file\n                              containing the private key and the certificate\n                              in PEM format.\n  --cache-dir <dir>           Store the cache data in <dir>.\n  --no-cache-dir              Disable the cache.\n  --disable-pip-version-check\n                              Don't periodically check PyPI to determine\n                              whether a new version of pip is available for\n                              download. Implied with --no-index.\n```\n\n#### 4. pip使用国内源\n\n详见[使用国内Pypi源加速Pypi包的安装](https://zhuxiongxian.cc/2017/06/30/using-pypi-domestic-sources-to-speed-up-the-installation-of-pypi-packages/)\n\n#### 5. pip配合虚拟环境virtualenv或virtualenvwrapper使用\n\n详见[python安装virtualenv和virtualenvwrapper](https://zhuxiongxian.cc/2017/09/28/python-install-virtualenv-and-virtualenvwrapper/)\n\n#### 6. pip常用命令\n\npip安装命令：\n\n```\n# pip install package_name\n```\n\npip升级命令：\n\n```\n# pip install --ungrage package_name\n```\n\n或\n\n```\n# pip install -U package_name\n```\n\npip卸载命令：\n\n```\n# pip uninstall package_name\n```\n\npip自身升级：\n\n```\n# pip install -U pip\n```\n\npip指定源安装其他软件包， 如指定`豆瓣源`安装软件包`setuptools`：\n\n```\n# pip install setuptools -i http://pypi.douban.com/simple/ --trusted-host pypi.douban.com\n```\n\n使用requirements格式输出已安装的包, 如下：\n\n```\n$ pip freeze\nBabel==2.5.1\nclick==6.7\nFlask==0.12.2\nFlask-Admin==1.5.0\nFlask-Babel==0.11.2\nFlask-BabelEx==0.9.3\nFlask-SQLAlchemy==2.3.2\nitsdangerous==0.24\nJinja2==2.9.6\nMarkupSafe==1.0\npytz==2017.3\nspeaklater==1.3\nSQLAlchemy==1.1.15\nWerkzeug==0.12.2\nWTForms==2.1\n```\n\n在实际开发中， 我们常常在不同的服务器运行相同的项目， 故需要相同的python环境， 所以我们将python环境的包以`requirements`格式输出到文件`requirements.txt`中去：\n\n```\n$ pip freeze > requirements.txt\n```\n\n#### 7. pip高级用法\n\npip支持自动补全功能， 对于zsh用户非常友好。 zsh用户使用如下命令就可以支持自动补全了：\n\n```\n$ pip completion --zsh >> ~/.zprofile\n$ source ~/.zprofile\n```\n或者在~/.zshrc里加一行：\n\n```\neval \"`pip completion --zsh`\"\n```\n\n如果使用bash, 则应该执行如下命令：\n\n```\n$ pip completion --bash >> ~/.profile\n```\n\n现在输入\"pip i<Tab>\"就会变成\"pip install\", 自动补全了install这个子命令。\n\nOK， Enjoy it~\n","tags":["linux","python","pip"],"categories":["python"]},{"title":"linux升级python2.6.x到python2.7.x","url":"/2017/11/09/linux-upgrade-python-version/","content":"\n低版本的centos6.x系统自带的python版本为2.6.x, 而平时的开发中都需要python2.7.x版本， 故本文记录下python2.6.x升级到python2.7.x的操作步骤。由于旧版本的python已被深度依赖， 所有不能卸载原有的python, 只能全新安装。\n\n#### 1. 安装依赖库\n\n```\n# yum install vim gcc make wget -y\n# yum install openssl-devel zlib-devel readline-devel sqlite-devel -y\n```\n\n#### 2. 源码编译安装python2.7.x\n\npython官网<https://www.python.org/>里下载python2.7.x源码最新版本`python2.7.14`，\n选择`Gzipped source tarball`， 下载`Python-2.7.14.tgz`：\n\n```\n$ wget -c https://www.python.org/ftp/python/2.7.14/Python-2.7.14.tgz\n$ tar -xvf Python-2.7.14.tgz\n$ cd Python-2.7.14\n$ ./configure --prefix=/usr/local/python2.7\n$ make\n$ sudo make install\n```\n\n#### 3. 将系统默认python版本变为python2.7\n\n```\n$ ln -fs /usr/local/python2.7/bin/python2.7 /usr/bin/python\n```\n\n#### 4. 查看python版本\n\n```\n$ python –V\n```\n\n#### 5. 修改yum配置里的python版本为python2.6\n\n```\n# vim /usr/bin/yum\n```\n\n将第一行的`#!/usr/bin/python`修改为系统原有的python版本地址`#!/usr/bin/python2.6`\n\n至此， 完成了python2.6.x升级到目前最新版本的`python2.7.14`。\nOK， Enjoy it~\n","tags":["linux","python"],"categories":["python"]},{"title":"linux定时任务crontab","url":"/2017/11/08/linux-timing-task-crontab/","content":"\ncron是一个在类Unix操作系统上的任务计划程序。它可以让用户在指定时间段周期性地运行命令或者shell脚本，通常被用在系统的自动化维护或者管理。cron的配置文件称为“crontab”，是“cron table”的简写。\n\n#### 1. 安装crontab\n\n```\n# yum install vixie-cron\n# yum install crontabs\n```\n\np.s.\n\n- vixie-cron 软件包是 cron 的主程序；\n- crontabs 软件包是用来安装、卸装、或列举用来驱动 cron 守护进程的表格的程序。\n- cron 的主配置文件是 `/etc/crontab`\n\n#### 2. crond服务操作命令\n\n```\n# service crond start   // 启动服务\n# service crond stop    // 关闭服务\n# service crond restart // 重启服务\n# service crond reload  // 重新载入配置\n# service crond status  // 查看服务状态\n```\n\n在centos系统中加入开机自动启动crond服务:\n\n```\n# chkconfig --level 345 crond on\n```\n\ncrond 服务（守护进程）在系统后台运行，并且会持续地检查 `/etc/crontab` 文件和 `/etc/cron.*/`目录。它同样也会检查 `/var/spool/cron/` 目录。\n\n#### 3. crontab格式\n\ncrontab 的基本格式是：\n\n```\n<分钟> <小时> <日> <月份> <星期> <命令>\n```\n\ncrontab文件格式简写：\n\n```\nf1 f2 f3 f4 f5 cmd\n```\n\n- `分钟`(f1) 值从 0 到 59\n- `小时`(f2) 值从 0 到 23\n- `日`(f3) 值从 1 到 31\n- `月`(f4) 值从 1 到 12\n- `星期`(f5) 值从 0 到 6, 0 代表星期日\n\n多个时间可以用逗号隔开，范围可以用连字符给出，星号可以作为通配符。空格用来分开字段。\n\n- 当 f1 为 `*` 时表示每分钟都要执行 cmd，f2 为 `*` 时表示每小时都要执行程序，依次类推\n- 当 f1 为 `a-b` 时表示从第 `a` 分钟到第 `b` 分钟这段时间内要执行，f2 为 `a-b` 时表示从第 `a` 到第 `b` 小时都要执行，依次类推\n- 当 f1 为 `*/n` 时表示每 `n` 分钟个时间间隔执行一次，f2 为 `*/n` 表示每 `n `小时个时间间隔执行一次，依次类推\n- 当 f1 为 `a, b, c,...` 时表示第 `a, b, c,...` 分钟要执行，f2 为 `a, b, c,... `时表示第 `a, b, c...`个小时要执行，依次类推\n- 使用者也可以将所有的设定先存放在档案 file 中，用 `crontab file` 的方式来设定时程表。\n\np.s.\n\n当程序在你所指定的时间执行后，系统会寄一封信给你，显示该程序执行的内容，若是你不希望收到这样的信，请在每一行空一格之后加上 `> /dev/null 2>&1` 即可\n\n后台运行命令:\n\n```\n$ nohup command > /dev/null 2>&1 &\n```\n\n#### 4. crontab命令\n\n语法:\n\n```\ncrontab [-u user] file\ncrontab [-u user] [ -i ] { -e | -l | -r }\n```\n\n参数：\n\n```\n-e      (edit user's crontab)\n-l      (list user's crontab)\n-r      (delete user's crontab)\n-i      (prompt before deleting user's crontab)\n```\n\n查看crontabs:\n\n```\n$ crontab -l\n```\n\n编辑 crontabs:\n\n```\n$ crontab -e\n```\n\n移除 crontabs:\n\n```\n$ crontab -r\n```\n\n如果用户有一个保存好的 crontab 想要用它完全覆盖旧的 crontab，可以使用：\n\n```\n$ crontab saved_crontab_filename\n```\n\n其中， 上面的`saved_crontab_filename`指的是已存在的crontab文件\n\n#### 5. crontab示例\n\n在每个月的每一天的每一个小时的第一分钟（例如，在12：01，1：01，2：01等）执行命令 `/bin/echo Hello, world!`\n\n```\n01 * * * * /bin/echo Hello, world!\n```\n\n将会在一月的每个工作日每五分钟（例如，在12：00，12：05，12：10等）执行一次相同的命令。\n\n```\n*/5 * * jan mon-fri /bin/echo Hello, world!\n```\n\n将会在每分钟都执行命令`/bin/echo Hello, world!`\n\n```\n* * * * * /bin/echo Hello, world!\n```\n\n每天早上7点执行一次 `/bin/ls` :\n\n```\n0 7 * * * /bin/ls\n```\n\n在 12 月内, 每天的早上 6 点到 12 点中，每隔3个小时执行一次 `/usr/bin/backup` :\n\n```\n0 6-12/3 * 12 * /usr/bin/backup\n```\n\n周一到周五每天下午 5:00 寄一封信给 `i@zhuxiongxian.com` :\n\n```\n0 17 * * 1-5 mail -s \"hi\" i@zhuxiongxian.com < /tmp/maildata\n```\n\n每月每天的午夜 0 点 20 分, 2 点 20 分, 4 点 20 分....执行 `echo \"haha\"`\n\n```\n20 0-23/2 * * * echo \"haha\"\n```\n\n","tags":["linux","定时任务","调度","cron","crontab"],"categories":["linux"]},{"title":"ubuntu主题美化","url":"/2017/10/31/ubuntu-theme-beautify/","content":"\n#### 1. 添加资源\n\n添加`Unity Tweak Tool`， `Flatabulous`主题和配套图标`ultra-flat`源：\n\n```\n$ sudo add-apt-repository ppa:noobslab/themes\n$ sudo add-apt-repository ppa:noobslab/icons\n$ sudo apt-get update\n```\n\n#### 2. 安装Unity Tweak Tool\n\n```\n$ sudo apt-get install unity-tweak-tool\n```\n\n#### 3. 安装Flatabulous主题和配套图标\n\n```\n$ sudo apt-get install -y flatabulous-theme\n$ sudo apt-get install -y ultra-flat-icons\n```\n\n#### 4. 应用Flatabulous主题和配套图标\n\n打开`Unity Tweak Tool`，点击“主题”按钮，选择`Flatabulous`应用主题，然后点击“图标”标签栏，选择`Ultra-flat`应用图标。\n\n#### 5. 安装zsh和oh-my-zsh\n\n请阅读[使用oh-my-zsh代替bash shell](https://zhuxiongxian.cc/2017/09/28/use-oh-my-zsh-instead-of-bash-shell/)\n\n![ubuntu主题美化](/img/article/ubuntu_beautify.png)\n","tags":["linux","ubuntu","美化","工具"],"categories":["ubuntu"]},{"title":"使用oh-my-zsh代替bash shell","url":"/2017/09/28/use-oh-my-zsh-instead-of-bash-shell/","content":"\n#### 1. zsh和oh-my-zsh安装\n\n参考链接:\n\n<https://github.com/robbyrussell/oh-my-zsh/wiki/Installing-ZSH>\n\n<https://github.com/robbyrussell/oh-my-zsh>\n\n```\n$ sudo apt-get install zsh\n$ sh -c \"$(wget https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -)\"\n$ chsh -s $(which zsh)\n$ chsh -s /bin/zsh\n```\n\n注销并重新启动终端即可.\n\n#### 2. 切换zsh和base shell\n\n切换回bash\n\n```\n$ chsh -s /bin/bash\n```\n\n或\n\n```\n$ chsh -s $(which bash)\n```\n\n注销并重新启动终端即可.\n\np.s.\n\nbash与zsh的切换实际在文件/etc/passwd里的\n`xx:x:1000:1000:xx:/home/xx:/bin/bash`与\n`xx:x:1000:1000:xx:/home/xx:/usr/bin/zsh`的切换\n\n#### 3. 常见问题解决\n\n`zsh: command not found: workon`解决方法如下:\n\n`$ vim .bash_profile`:\n\n```\nexport PATH=/bin:/usr/bin:/usr/local/bin:$PATH\n```\n\n激活`virtualenvwrapper`, 使`workon`命令生效:\n\n```\n$ source .bash_profile\n$ echo source ~/.bash_profile >> ~/.zshrc\n$ echo source /usr/local/bin/virtualenvwrapper.sh >> ~/.zshrc\n$ source /usr/local/bin/virtualenvwrapper.sh\n```\n","tags":["linux","ubuntu","美化","工具"],"categories":["linux"]},{"title":"python安装virtualenv和virtualenvwrapper","url":"/2017/09/28/python-install-virtualenv-and-virtualenvwrapper/","content":"\n#### 1. pip常用命令\n\npip安装命令： pip install package_name\n\npip升级命令：pip install --ungrage package_name \n\n或：pip install -U package_name\n\npip卸载命令：pip uninstall package_name\n\n如\npip install django\npip install -U django\n\n#### 2. virtualenv的安装\n\nvirtualenv的安装:\n\n    $ sudo pip install virtualenv\n    \n或\n\n    $ sudo apt-get install python-virtualenv\n    \n如果是Mac OS X 系统， 就可以用easy_install安装virtualenv:\n\n    $ sudo easy_install virtualenv\n    \n查看virtualenv的版本号， 或检查系统是否是否安装了virtualenv: \n\n    $ virtualenv --version\n\n用virtualenv创建虚拟环境， 一般虚拟环境被命名为venv:\n\n    $ virtualenv venv\n\n激活这个虚拟环境：\n\n    $ source venv/bin/activate\n\n如果使用微软windows系统， 激活命令是：\n\n    $ venv\\Script\\activate\n    \n激活虚拟环境的命令会修改命令行提示符， 加入环境名：\n\n    (venv) $\n当虚拟环境中的工作完成后， 如果你想回到全局Python解释器中， 可以在命令行提示符下输入deactivate\n执行以下命令可在虚拟环境中安装Flask\n\n    (venv) $ pip install flask\n    \n验证Flask是否正确安装：\n\n    (venv) $ python\n    >>> import flask\n    >>>\n\n#### 3. virtualenvwrapper的安装\nvirtualenvwrapper的安装:\n\n    $ sudo pip install virtualenvwrapper\n安装完成后， 会在下面的位置生成virtualwrapper的shell脚本。\n\n    /usr/local/bin/virtualenvwrapper.sh\n    \n在使用virtualenvwrapper时， 需要配置登录的shell初始化脚本， 将virtualenvwrapper.sh的信息读入当前的shell环境。这里以base为例， 通过对用户根目录下（即/home/[username]）的.bashrc配置文件进入如下修改即可。\n\np.s. `zsh shell`环境的用户， 则相应修改的是/home/[username]的.zshrc配置文件.\n\n修改.bashrc:\n\n    if [ -f /usr/local/bin/virtualenvwrapper.sh ]; then\n        export WORKON_HOME=$HOME/.virtualenvs\n        source /usr/local/bin/virtualenvwrapper.sh\n    fi\n\n再次读入.bashrc:\n\n    $ source ~/.bashrc\n我们可以输入命令mkvirtualenv， 看一下其是否可用。\n\n    $ mkvirtualenv --help\n\n设置好之后，你就可以通过下面的命令来操作虚拟环境了：\n\n建立虚拟环境：\n\n    $ mkvirtualenv env\n确认虚拟环境：\n\n    $ ls -la $HOME/.virtualenvs\n\n\n与virtualenv的相同处与不同处， 其中， 退出虚拟运行环境的命令同样是deactivate， 进入虚拟运行环境的命令变为workon。\n退出虚拟环境：\n\n    (venv) $ deactivate\n进入已存在的环境或者切换环境, 假设存在虚拟环境名为env：\n\n    $ workon env\n浏览虚拟环境:\n\n    $ workon\n删除虚拟环境：\n    \n    $ rmvirtualenv env\n\n#### 4. 在虚拟环境下一键安装pip常用package\n\nrequirements.txt文件里写入`package`或`package==版本号`或`package>=版本号`:\n\n    Django==1.7.7\n    django-debug-toolbar\n    ply\n    MySQL-python\n    uwsgi\n    flup\n    Flask\n    Pillow\n    markdown2\n\n一键安装命令:\n\n    (venv) $ pip install -r requirements.txt\n\n在执行上面的一键安装命令过程中, 配置MySQL-Python的时候系统报错，提示：\n\n    EnvironmentError: mysql_config not found\n\ngoogle搜索`EnvironmentError: mysql_config not found`,　在[stackoverflow](http://stackoverflow.com/questions/5178292/pip-install-mysql-python-fails-with-environmenterror-mysql-config-not-found)找到答案\n\n    (venv) $ sudo apt-get install libmysqlclient-dev\n\n#### 5. 其他常用的命令\n\n- lsvirtualenv: 列出全部的虚拟环境\n- showvirtualenv: 列出单个虚拟环境的信息\n- rmvirtualenv: 删除一个虚拟环境\n- cpvirtualenv: 拷贝虚拟环境\n- allvirtualenv: 对当前虚拟环境执行统一的命令。 比如， 要给 venv1 和 venv2 都安装flask, 就可以用`allvirtualenv pip install flask`\n- cdvirtualenv: 可以直接切换到虚拟环境的子目录里面\n\n> (venv1)> cdvirtualenv bin\n> \n> (venv1)> pwd\n> /home/ubuntu/venv/venv1/bin\n> \n\n- cdsitepackages: 和cdvirtualenv同理， 切换到虚拟环境的site-packages目录下\n- lssitepackages: 列出site-packages目录下的目录\n","tags":["python","virtualenv","virtualenvwrapper"],"categories":["python"]},{"title":"使用国内Pypi源加速Pypi包的安装","url":"/2017/06/30/using-pypi-domestic-sources-to-speed-up-the-installation-of-pypi-packages/","content":"\n#### 1. 国内常用的pip源\n\n* 阿里云pypi源: <http://mirrors.aliyun.com/pypi/simple/> (`推荐`)\n* 豆瓣pypi源: <http://pypi.douban.com/simple> (`推荐`)\n\n#### 2. 设置pip默认源\n\n```\n$ mkdir ~/.pip\n$ cd ~/.pip/\n$ vim pip.conf\n```\n\npip.conf内容如下：\n\n使用阿里云的pypi源:\n\n```\n[global]\ntimeout = 6000\nindex-url = http://mirrors.aliyun.com/pypi/simple/\ntrusted-host = mirrors.aliyun.com\n```\n\nor\n\n```\n[global]\nindex-url = https://mirrors.aliyun.com/pypi/simple/\n\n[install]\ntrusted-host=mirrors.aliyun.com\n```\n\n使用豆瓣的pypi源:\n\n```\n[global]\nindex-url = http://pypi.douban.com/simple\ntrusted-host = pypi.douban.com\n# disable-pip-version-check = true\ntimeout = 6000\n```\n\nOK, Enjoy it~\n","tags":["python","pip"],"categories":["python"]},{"title":"mongodb shell常用命令","url":"/2017/06/23/mongodb-shell-common-commands/","content":"\n#### 1. 进入mongodb shell\n\n```\n$ mongo\nMongoDB shell version v3.4.4\nconnecting to: mongodb://127.0.0.1:27017\nMongoDB server version: 3.4.4\n\n>\n```\n\n#### 2. 退出mongodb shell\n\n```\n> exit\nbye\n```\n\n#### 3. 查看mongodb版本号\n\n```\n> db.version()\n3.4.4\n```\n\n#### 4. 查看数据库操作命令\n\n```\n> db.help()\n```\n\n#### 5. 显示数据库列表\n\n```\n> show dbs\n```\n\n#### 6. 切换或创建数据库\n\n```\n> use db_name\n```\n\n示例:\n```\n> use shake\nswitched to db shake\n```\n\np.s. 如果数据库不存在, 则创建数据库, 否则切换到指定数据库.\n\n#### 7. 显示所有用户\n\n```\n> show users\n```\n\n#### 8. 显示当前数据库中的集合\n\n```\n> show collections\n```\n\np.s. 类似关系数据库中的表table\n\n#### 9. 显示集合操作命令\n\n```\n> db.yourCollection.help()\n```\n\np.s. yourCollection是集合名\n\n#### 10. 显示当前所用的数据库\n\n```\n> db\n```\n\n#### 11. 删除已有的字段\n\n```\n> db.yourcollection.update({},{$unset:{\"yourfield\":\"\"}},false,true)\n```\n\np.s. yourCollection是集合名, yourfield是要删除的字段\n\n示例:\n```\n> db.user.update({},{$unset:{\"balance\":\"\"}},false,true)\nWriteResult({ \"nMatched\" : 2, \"nUpserted\" : 0, \"nModified\" : 2 })\n> \n```\n\n#### 12. 新增字段\n\n```\n> db.yourcollection.update({}, {$set:{'yourfield': \"\"}}, {multi:true})\n```\n\np.s. yourCollection是集合名, yourfield是要新增的字段\n\n示例:\n```\n> db.user.update({}, {$set:{'follower_num_limit': 0}}, {multi:true})\nWriteResult({ \"nMatched\" : 2, \"nUpserted\" : 0, \"nModified\" : 2 })\n> \n```\n\n#### 13. 删除当前数据库\n\n删除当前数据库，默认为 test，你可以使用 db 命令查看当前数据库名。\n```\n> db.dropDatabase()\n```\n最后，我们再通过 show dbs 命令数据库是否删除成功：\n```\n> show dbs\nlocal  0.078GB\ntest   0.078GB\n> \n```\n\n#### 14. 插入文档\n\nMongoDB 使用 insert() 或 save() 方法向集合中插入文档, 语法如下:\n\n```\ndb.COLLECTION_NAME.insert(document)\n```\n\n插入文档你也可以使用 db.COLLECTION_NAME.save(document) 命令。如果不指定 _id 字段 save() 方法类似于 insert() 方法。如果指定 _id 字段，则会更新该 _id 的数据。\n\n示例:\n\n```\ndb.user.insert({\"name\": \"xx\", \"age\"；25, \"gender\": \"male\"})\nWriteResult({ \"nInserted\" : 1 })\n```\n\n#### 15. 更新文档\n\n##### 15.1. update()方法\n\nMongoDB 使用 update() 和 save() 方法来更新集合中的文档.\nupdate() 方法用于更新已存在的文档。语法格式如下：\n\n```\n> db.collection.update(\n    <query>,\n    <update>,\n    {\n        upsert: <boolean>,\n        multi: <boolean>,\n        writeConcern: <document>\n    }\n)\n```\n参数说明：\n\n- query : update的查询条件，类似sql update查询内where后面的。\n- update : update的对象和一些更新的操作符（如$,$inc...）等，也可以理解为sql update查询内set后面的\n- upsert : 可选，这个参数的意思是，如果不存在update的记录，是否插入objNew,true为插入，默认是false，不插入。\n- multi : 可选，mongodb 默认是false,只更新找到的第一条记录，如果这个参数为true,就把按条件查出来多条记录全部更新。\n- writeConcern :可选，抛出异常的级别。\n\n示例:\n\n```\n> db.col.insert({\n    title: 'MongoDB常用命令', \n    url: 'https://zhuxiongxian.cc',\n    tags: ['mongodb', 'database', 'NoSQL']\n})\n```\n接着通过 update() 方法来更新标题`title`:\n\n```\n> db.col.update({'title':'MongoDB常用命令'},{$set:{'title':'MongoDB'}})\nWriteResult({ \"nMatched\" : 1, \"nUpserted\" : 0, \"nModified\" : 1 })\n```\n以上语句只会修改第一条发现的文档，如果你要修改多条相同的文档，则需要设置 multi 参数为 true。\n```\n> db.col.update({'title':'MongoDB常用命令'},{$set:{'title':'MongoDB'}},{multi:true})\n```\n\n##### 15.2. save()\n\nsave() 方法通过传入的文档来替换已有文档。语法格式如下：\n```\n> db.collection.save(\n   <document>,\n   {\n     writeConcern: <document>\n   }\n)\n```\n参数说明：\n\n- document : 文档数据。\n- writeConcern :可选，抛出异常的级别。\n\n##### 15.3. 数据更新操作符\n\n`$inc`\n\n- 用法：{$inc:{field:value}}\n- 作用：对一个数字字段的某个field增加value\n\n`$set`\n\n- 用法：{$set:{field:value}}\n- 作用：把文档中某个字段field的值设为value\n\n`$unset`\n\n- 用法：{$unset:{field:1}}\n- 作用：删除某个字段field\n\n`$push`\n\n- 用法：{$push:{field:value}}\n- 作用：把value追加到field里。注：field只能是数组类型，如果field不存在，会自动插入一个数组类型\n\n`$pushAll`\n\n- 用法：{$pushAll:{field:value_array}}\n- 作用：用法同$push一样，只是$pushAll可以一次追加多个值到一个数组字段内。\n\n#### 16. 删除文档\n\n#### 17. 查询文档\n\n继续补充...","tags":["mongodb","数据库","命令"],"categories":["mongodb"]},{"title":"ubuntu16.04安装jdk8","url":"/2017/06/17/Ubuntu1604-install-jdk8/","content":"\n#### 1. jdk8下载\njdk8下载地址：\n\n<http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html>\n\nwget命令下载：\n\n```\n# wget -c \"http://download.oracle.com/otn-pub/java/jdk/8u131-b11/d54c1d3a095b4ff2b6607d096fa80163/jdk-8u131-linux-x64.tar.gz?AuthParam=1497695563_383d66db9da8433b3436920c19daace9\"\n```\n    \n文件重命名得到`jdk-8u131-linux-x64.tar.gz`:\n\n```\n# mv jdk-8u131-linux-x64.tar.gz?AuthParam=1497695563_383d66db9da8433b3436920c19daace9 jdk-8u131-linux-x64.tar.gz\n```\n\n#### 2. 解压缩\n\n解压`jdk-8u131-linux-x64.tar.gz`得到目录`jdk1.8.0_131`:\n\n```\n# tar -xzvf jdk-8u131-linux-x64.tar.gz\n```\n\n#### 3. 指定jdk的安装目录\n\n指定jdk安装目录为`/usr/local/java/`\n\n```\n# mkdir -p /usr/local/java/\n```\n\n移动目录`jdk1.8.0_131`到`/usr/local/java/`下：\n\n```\n# mv jdk1.8.0_131/ /usr/local/java/\n# cd /usr/local/java/\n# ls\njdk1.8.0_131\n```\n\n#### 4. 配置环境变量\n\n修改文件`~/.bash_profile`\n\n```\n# vim ~/.bash_profile\n```\n\n在`~/.bash_profile`文件内容最后追加:\n\n```\nexport JAVA_HOME=/usr/local/java/jdk1.8.0_131\nexport CLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar\nexport PATH=$PATH:$JAVA_HOME/bin\n```\n\n`:wq`保存退出\n使文件`~/.bash_profile`重新生效\n\n```\n# source ~/.bash_profile\n```\n\n***p.s.*** 若终端由`/bin/bash`改用了`/bin/zsh`， 则在zsh的配置文件`~/.zshrc`最后追加上：\n\n```\nsource ~/.bash_profile\n```\n\n我们把jdk的环境变量的配置信息放在`~/.bash_profile`这个配置文件中， 这样每次打开终端的时候， zsh就会执行一次环境变量配置信息， 我们就能在终端使用jdk的相关命令了， 如jar, java, javac等 。\n\n#### 5. 检测jdk8是否成功安装\n\n```\n$ java -version\njava version \"1.8.0_131\"\nJava(TM) SE Runtime Environment (build 1.8.0_131-b11)\nJava HotSpot(TM) 64-Bit Server VM (build 25.131-b11, mixed mode)\n$ \n```\n\nOk， Enjoy it~\n","tags":["jdk","ubuntu","java"],"categories":["ubuntu"]},{"title":"ubuntu16.04为google chrome安装adobe-flashplugin","url":"/2017/06/08/Ubuntu1604-install-adobe-flashplugin-for-google-chrome/","content":"\n#### 1. apt命令安装adobe-flashplugin\n\n```\n$ sudo apt-get install adobe-flashplugin\n```\n\n#### 2. deb包安装adobe-flashplugin\n\nadobe-flashplugin的deb包下载地址:\n\n<http://archive.canonical.com/pool/partner/a/adobe-flashplugin/>\n\n首先查看系统版本号:\n\n```\n$ uname -a\nLinux xxpc 4.8.0-52-generic #55~16.04.1-Ubuntu SMP Fri Apr 28 14:36:29 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\n```\n\n可知当前ubuntu版本号为`16.04.1`, 选择`adobe-flashplugin_20170509.1-0ubuntu0.16.04.1_amd64.deb`进行下载\n\n```\n$ wget -c http://archive.canonical.com/pool/partner/a/adobe-flashplugin/adobe-flashplugin_20170509.1-0ubuntu0.16.10.1_amd64.deb\n```\n\n安装deb包:\n\n```\n$ sudo dpkg -i adobe-flashplugin_20170509.1-0ubuntu0.16.10.1_amd64.deb\n```\n\n若出现以下冲突信息：\n\n```\n$ sudo dpkg -i adobe-flashplugin_20170509.1-0ubuntu0.16.10.1_amd64.deb\nSelecting previously unselected package adobe-flashplugin.\ndpkg: regarding adobe-flashplugin_20170509.1-0ubuntu0.16.10.1_amd64.deb containing adobe-flashplugin:\n adobe-flashplugin conflicts with flashplugin-installer\n  flashplugin-installer (version 25.0.0.171ubuntu0.16.04.1) is present and installed.\n\ndpkg: error processing archive adobe-flashplugin_20170509.1-0ubuntu0.16.10.1_amd64.deb (--install):\n conflicting packages - not installing adobe-flashplugin\nErrors were encountered while processing:\n adobe-flashplugin_20170509.1-0ubuntu0.16.10.1_amd64.deb\n```\n\n则将`flashplugin-installer`卸载, 再执行安装`adobe-flashplugin`命令：\n\n```\n$ sudo apt-get remove flashplugin-installer\n$ sudo dpkg -i adobe-flashplugin_20170509.1-0ubuntu0.16.10.1_amd64.deb\n```\n\n然后重新打开终端， 输入命令：\n\n```\n$ google-chrome\n```\n    \n重启google chrome浏览器即可生效.\n","tags":["ubuntu","google chrome","flashpluin"],"categories":["ubuntu"]},{"title":"ubuntu16.04安装sublime text 3","url":"/2017/06/05/Ubuntu1604-install-sublimetext3/","content":"\n#### 1. 安装/卸载sublime text 3\n\n`sublime text 3`官方安装教程:\n<https://www.sublimetext.com/docs/3/linux_repositories.html>\n\n##### 1.1. 安装GPG key\n\n```\n$ wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | sudo apt-key add -\n```\n\n##### 1.2. 确保apt被设置为与https源一起工作\n\n```\n$ sudo apt-get install apt-transport-https\n```\n\n##### 1.3. 选择安装稳定版或开发版APT源\n\n`稳定版`\n\n```\n$ echo \"deb https://download.sublimetext.com/ apt/stable/\" | sudo tee /etc/apt/sources.list.d/sublime-text.list\n```\n\n`开发版`\n\n```\n$ echo \"deb https://download.sublimetext.com/ apt/dev/\" | sudo tee /etc/apt/sources.list.d/sublime-text.list\n```\n\n##### 1.4. 更新APT源并安装sublime text\n\n```\n$ sudo apt-get update\n$ sudo apt-get install sublime-text\n```\n\n`sublime text`安装目录为`/opt/sublime_text`, 在终端启动命令为`subl`\n\n##### 1.5. 卸载sublime text 3\n\n```\n$ sudo apt-get remove sublime-text\n```\n\n#### 2. 使sublime text支持中文输入法\n\n安装搜狗输入法 for linux:\n\nhttp://pinyin.sogou.com/linux/\n\n下载deb包， 使用`dpkg -i xxx.deb`即可安装.\n\n克隆项目到本地 :\n\n```\n$ git clone https://github.com/lyfeyaj/sublime-text-imfix.git\n```\n\n运行脚本 :\n\n```\n$ cd sublime-text-imfix && ./sublime-imfix\n```\n\n完成! 重新启动后就可以在 Sublime Text 3 中 使用 Fcitx进行中文输入了.\n\n#### 3. 安装插件管理器Package Control\n\n快捷键: ctrl  + `打开 console, 输入以下内容 并回车:\n\n```lang-py\nimport urllib.request,os; pf = 'Package Control.sublime-package'; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); open(os.path.join(ipp, pf), 'wb').write(urllib.request.urlopen( 'http://sublime.wbond.net/' + pf.replace(' ',' ')).read())\n```\n\n重启软件后可以在Preference菜单下找到Package Control命令，单击运行Packeage Control，搜索Install Package并进入该选项，此时即可为Sublime Text 3安装所需插件.\n\n#### 4. sublime text 3常用插件\n\n快捷键 Ctrl+Shift+P（菜单 – Tools – Command Paletter），输入 install 选中Install Package并回车，输入或选择你需要的插件回车就安装了（注意左下角的小文字变化，会提示安装成功）。\n\n再输入插件名称就可以安装插件, 常用的插件有:\n\n```\nBracket Highlighter\nSublime CodeIntel\nDocBlockr\ngit\nEmmet\njQuery\nAutoFileName\nIMESupport\nrequirementstxt\nMarkdown Preview\nMarkdownLivePreview         # \"markdown_live_preview_on_open\": false，改为true\nMarkdown Editing     \nAdvancedNewFile     # \"default_root\": \"project_folder\"，改为current\nJedi\nPython AutoComplete\nSideBarEnhancements\nSublimeLinter\nanaconda\nAlignment   # 代码对齐， Ctrl+Alt+A\nCtags   # 函数跳转， Alt+点击 函数名称，会跳转到相应的函数\nIndex XML   # xml格式化\n```\n\n#### 5. sublime text 3安装主题Theme - Brogrammer\n\nhttps://github.com/kenwheeler/brogrammer-theme?files=1\n\n`ctrl + shift + p`, install packages\nTheme is listed as `Theme - Brogrammer` in Will Bond's Sublime Package Control.\n\n效果图如下：\n\n![sublime text 3](/img/article/Screenshot000002.png )\n\nOK， Enjoy it~\n","tags":["ubuntu","sublime text"],"categories":["ubuntu"]}]